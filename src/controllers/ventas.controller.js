const a0_0x2178a1=a0_0x1706;(function(_0x33bdcd,_0x7e3dc0){const _0x3f5dbd=a0_0x1706,_0x526bf7=_0x33bdcd();while(!![]){try{const _0x24fe7b=parseInt(_0x3f5dbd(0x285))/0x1*(-parseInt(_0x3f5dbd(0x21b))/0x2)+-parseInt(_0x3f5dbd(0x1cf))/0x3+-parseInt(_0x3f5dbd(0x27e))/0x4+parseInt(_0x3f5dbd(0x218))/0x5*(-parseInt(_0x3f5dbd(0x148))/0x6)+parseInt(_0x3f5dbd(0x277))/0x7*(parseInt(_0x3f5dbd(0x19d))/0x8)+parseInt(_0x3f5dbd(0x231))/0x9+parseInt(_0x3f5dbd(0x14c))/0xa*(parseInt(_0x3f5dbd(0x1bf))/0xb);if(_0x24fe7b===_0x7e3dc0)break;else _0x526bf7['push'](_0x526bf7['shift']());}catch(_0x44fc36){_0x526bf7['push'](_0x526bf7['shift']());}}}(a0_0x265e,0xee8b0));function a0_0x1706(_0x3feec8,_0x67be9c){const _0x265e45=a0_0x265e();return a0_0x1706=function(_0x170633,_0x1b7745){_0x170633=_0x170633-0xf8;let _0x3c0209=_0x265e45[_0x170633];return _0x3c0209;},a0_0x1706(_0x3feec8,_0x67be9c);}const {Ventas,Detalle_Venta,Productos,Producto_Tallas,Producto_Tamano_Insumos,Producto_Tamano,Tamano,Tamano_Insumos,Tallas,Agendamientos,Empleados,Servicios,Clientes,Insumos}=require(a0_0x2178a1(0x23d)),{sequelize}=require(a0_0x2178a1(0x13a)),{UniqueConstraintError,ValidationError,DatabaseError}=require(a0_0x2178a1(0x1c7)),validarCliente=async(_0x311b2a,_0x23be0d)=>{const _0x5ca16c=a0_0x2178a1,_0x56bd9d={'OIhTw':_0x5ca16c(0x273)},_0x3c01e3=await Clientes[_0x5ca16c(0x211)](_0x311b2a,{'transaction':_0x23be0d});if(!_0x3c01e3)throw new Error(_0x56bd9d['OIhTw']);return _0x3c01e3;},validarEmpleado=async(_0x316508,_0x34e13a)=>{const _0x4c462d=a0_0x2178a1,_0xeced20={'ejPdp':_0x4c462d(0x1cc)},_0x3689e6=await Empleados[_0x4c462d(0x211)](_0x316508,{'transaction':_0x34e13a});if(!_0x3689e6)throw new Error(_0xeced20[_0x4c462d(0x1ba)]);return _0x3689e6;},validarMetodoPago=(_0x42baa9,_0x5c8992)=>{const _0x3e9238=a0_0x2178a1,_0x4c45cd={'zpzhL':_0x3e9238(0x15b),'WIDqs':'Tarjeta','mhmQN':'Transferencia'},_0x57e74d=[_0x4c45cd[_0x3e9238(0x249)],_0x4c45cd[_0x3e9238(0x166)],_0x4c45cd[_0x3e9238(0x1f0)],_0x3e9238(0x284)];if(!_0x57e74d[_0x3e9238(0x1dd)](_0x42baa9))throw new Error(_0x3e9238(0x27f));if(_0x42baa9===_0x3e9238(0x169)&&!_0x5c8992)throw new Error(_0x3e9238(0x125));},calcularPrecio=async(_0x4ae3bb,_0x664d69,_0x1d0e26,_0x7cb15a,_0x43d557)=>{const _0x48b401=a0_0x2178a1,_0x35df32={'ThnCA':function(_0x32c99c,_0x2b80b3){return _0x32c99c(_0x2b80b3);},'iiaTq':function(_0x3b047c,_0x1f337c){return _0x3b047c+_0x1f337c;},'xNZpk':function(_0x5b7971,_0x431d4f){return _0x5b7971>_0x431d4f;},'MGaek':function(_0x3a3bbf,_0x470333){return _0x3a3bbf(_0x470333);},'EawcX':function(_0x2fdb4f,_0x3f9a7b){return _0x2fdb4f+_0x3f9a7b;},'HJjBv':function(_0x4c55da,_0x2ca593){return _0x4c55da(_0x2ca593);},'uFXLR':function(_0x442b33,_0x374e57){return _0x442b33*_0x374e57;},'vtJBt':function(_0x471106,_0x4ec498){return _0x471106(_0x4ec498);},'wOFzp':function(_0x214b41,_0x3f3543){return _0x214b41*_0x3f3543;}};let _0x2d8478=0x0;try{if(_0x1d0e26&&_0x35df32['xNZpk'](_0x1d0e26['length'],0x0))for(const _0x382da9 of _0x1d0e26){const _0x308051=_0x35df32[_0x48b401(0x131)](Number,_0x382da9[_0x48b401(0x206)]||0x0);_0x2d8478+=_0x308051;}else{if(_0x664d69&&_0x664d69[_0x48b401(0x1d4)]>0x0)for(const _0x213f46 of _0x664d69){const _0x442c48=await Producto_Tallas[_0x48b401(0x10b)]({'where':{'Id_Productos':_0x4ae3bb[_0x48b401(0x165)],'Talla':_0x213f46[_0x48b401(0x1fa)]},'transaction':_0x43d557});if(_0x442c48){const _0x5a1e93=_0x35df32[_0x48b401(0x28d)](_0x35df32[_0x48b401(0x131)](Number,_0x4ae3bb[_0x48b401(0x1ab)]),_0x35df32['HJjBv'](Number,_0x442c48['Precio']))*_0x213f46[_0x48b401(0x146)];_0x2d8478+=_0x5a1e93;}else{const _0x2305b5=_0x35df32[_0x48b401(0x1ca)](Number(_0x4ae3bb[_0x48b401(0x1ab)]),_0x213f46[_0x48b401(0x146)]);_0x2d8478+=_0x2305b5;}}else _0x2d8478=_0x35df32[_0x48b401(0x208)](Number,_0x4ae3bb[_0x48b401(0x1ab)])*_0x7cb15a;}(!_0x2d8478||_0x35df32[_0x48b401(0x122)](isNaN,_0x2d8478))&&(_0x1d0e26&&_0x35df32['xNZpk'](_0x1d0e26[_0x48b401(0x1d4)],0x0)?_0x2d8478=_0x1d0e26[_0x48b401(0x1ac)]((_0x3a5706,_0xeb048a)=>{const _0x125788=_0x48b401,_0x2a85c9=_0x35df32[_0x125788(0x224)](Number,_0xeb048a[_0x125788(0x206)]||0x0);return _0x35df32['iiaTq'](_0x3a5706,_0x2a85c9);},0x0):_0x2d8478=_0x35df32['wOFzp'](Number(_0x4ae3bb[_0x48b401(0x1ab)]),_0x7cb15a));}catch(_0x53bbb5){_0x2d8478=_0x35df32['uFXLR'](_0x35df32[_0x48b401(0x208)](Number,_0x4ae3bb[_0x48b401(0x1ab)]),_0x7cb15a);}return _0x2d8478;},actualizarStockProducto=async(_0x977264,_0x528b03,_0x5ca09a)=>{const _0x2e3a50=a0_0x2178a1,_0xcd4618={'Ceyql':function(_0x5c0cf1,_0x2e2512){return _0x5c0cf1(_0x2e2512);},'wIGMY':function(_0x26a225,_0x3d51c){return _0x26a225-_0x3d51c;}},_0x13ba0b=await Productos[_0x2e3a50(0x211)](_0x977264,{'transaction':_0x5ca09a});if(!_0x13ba0b)throw new Error('Producto\x20con\x20ID\x20'+_0x977264+_0x2e3a50(0x1b8));const _0x3e5432=_0xcd4618[_0x2e3a50(0x178)](Number,_0x13ba0b[_0x2e3a50(0x19f)]||0x0),_0x1ed3f8=_0xcd4618[_0x2e3a50(0x118)](_0x3e5432,_0x528b03);if(_0x1ed3f8<0x0)throw new Error('Stock\x20insuficiente\x20para\x20el\x20producto\x20'+_0x13ba0b[_0x2e3a50(0x1d2)]+_0x2e3a50(0x1db)+_0x3e5432+_0x2e3a50(0x106)+_0x528b03);return await _0x13ba0b['update']({'Stock':_0x1ed3f8},{'transaction':_0x5ca09a}),_0x1ed3f8;},actualizarStockTallas=async(_0x402cbe,_0x3b9736,_0x3e09b7)=>{const _0x2502a4=a0_0x2178a1,_0xd3efac={'WlwBR':function(_0x1d4d90,_0x2cb5a3){return _0x1d4d90(_0x2cb5a3);},'jRMba':function(_0x48fbc2,_0xa6be72){return _0x48fbc2<_0xa6be72;},'BDUba':function(_0x16ba8d,_0x39fcc4){return _0x16ba8d>_0x39fcc4;},'SLUrw':function(_0x527dbe,_0x889ee4){return _0x527dbe(_0x889ee4);},'ogfZJ':function(_0x251115,_0x305984){return _0x251115<_0x305984;}};let _0x281a9e=0x0;for(const _0x316f0a of _0x3b9736){const _0x3ca123=_0x316f0a[_0x2502a4(0x1fa)]||_0x316f0a[_0x2502a4(0x23b)]||_0x316f0a[_0x2502a4(0x207)]||'';if(!_0x3ca123)throw new Error(_0x2502a4(0x1cd)+_0x402cbe);const _0x1c5cb5=await Tallas[_0x2502a4(0x10b)]({'where':{'Nombre':_0x3ca123},'transaction':_0x3e09b7});if(!_0x1c5cb5)throw new Error(_0x2502a4(0x1e6)+_0x3ca123+_0x2502a4(0x216));const _0x565e4f=await Producto_Tallas[_0x2502a4(0x10b)]({'where':{'Id_Productos':_0x402cbe,'Id_Tallas':_0x1c5cb5[_0x2502a4(0x147)]},'transaction':_0x3e09b7});if(!_0x565e4f)throw new Error(_0x2502a4(0x1e6)+_0x3ca123+_0x2502a4(0x1fd)+_0x402cbe);const _0x4e7a14=_0xd3efac[_0x2502a4(0x1de)](Number,_0x565e4f[_0x2502a4(0x19f)]||0x0),_0x5435ed=_0xd3efac[_0x2502a4(0x1de)](Number,_0x316f0a[_0x2502a4(0x146)]||_0x316f0a['Cantidad']||0x0),_0x2b8e57=_0x4e7a14-_0x5435ed;if(_0xd3efac[_0x2502a4(0x19b)](_0x2b8e57,0x0))throw new Error(_0x2502a4(0x1ea)+_0x3ca123+_0x2502a4(0x1db)+_0x4e7a14+_0x2502a4(0x106)+_0x5435ed);await _0x565e4f[_0x2502a4(0x20d)]({'Stock':_0x2b8e57},{'transaction':_0x3e09b7}),_0x281a9e+=_0x5435ed;}if(_0xd3efac['BDUba'](_0x281a9e,0x0)){const _0x55e5e1=await Productos['findByPk'](_0x402cbe,{'transaction':_0x3e09b7});if(!_0x55e5e1)throw new Error(_0x2502a4(0x21f)+_0x402cbe+_0x2502a4(0x1b8));const _0x361da0=_0xd3efac['SLUrw'](Number,_0x55e5e1[_0x2502a4(0x19f)]||0x0),_0x20ebba=_0x361da0-_0x281a9e;if(_0xd3efac[_0x2502a4(0x1b5)](_0x20ebba,0x0))throw new Error(_0x2502a4(0x13c)+_0x55e5e1[_0x2502a4(0x1d2)]+'.\x20Disponible:\x20'+_0x361da0+',\x20Solicitado:\x20'+_0x281a9e);await _0x55e5e1[_0x2502a4(0x20d)]({'Stock':_0x20ebba},{'transaction':_0x3e09b7});}},actualizarStockInsumos=async(_0x2b3ded,_0x2050b2,_0x3a755c)=>{const _0x14bbfb=a0_0x2178a1,_0x2fc678={'tINhh':_0x14bbfb(0x1a1),'cSleo':function(_0x50d863,_0x4bda2d){return _0x50d863(_0x4bda2d);},'tHrvH':function(_0x448e04,_0x2366fb){return _0x448e04*_0x2366fb;},'NegIU':function(_0x2a888f,_0x6395a3){return _0x2a888f(_0x6395a3);},'iLFem':function(_0x2943ae,_0xb84904){return _0x2943ae-_0xb84904;}};for(const _0x319c8a of _0x2050b2){const _0x3bac85=_0x319c8a[_0x14bbfb(0x207)]||_0x319c8a[_0x14bbfb(0x1d2)]||'';if(!_0x3bac85)throw new Error(_0x14bbfb(0x25c)+_0x2b3ded);const _0x69862c=await Tamano[_0x14bbfb(0x10b)]({'where':{'Nombre':_0x3bac85},'transaction':_0x3a755c});if(!_0x69862c)throw new Error(_0x14bbfb(0x278)+_0x3bac85+'\x20no\x20encontrado');const _0x5b067b=await Producto_Tamano[_0x14bbfb(0x10b)]({'where':{'Id_Productos':_0x2b3ded,'Id_Tamano':_0x69862c[_0x14bbfb(0x112)]},'transaction':_0x3a755c});if(!_0x5b067b)throw new Error(_0x14bbfb(0x139)+_0x2b3ded+_0x14bbfb(0x1f1)+_0x319c8a[_0x14bbfb(0x207)]+_0x14bbfb(0x221));const _0xfacdeb=await Producto_Tamano_Insumos[_0x14bbfb(0x205)]({'where':{'Id_Producto_Tamano':_0x5b067b[_0x14bbfb(0x132)]},'include':[{'model':Insumos,'as':_0x2fc678[_0x14bbfb(0x182)]}],'transaction':_0x3a755c}),_0x4fc691=await Tamano_Insumos[_0x14bbfb(0x205)]({'where':{'Id_Tamano':_0x69862c[_0x14bbfb(0x112)]},'include':[{'model':Insumos,'as':'Id_Insumos_Insumo'}],'transaction':_0x3a755c}),_0x466e63=Number(_0x319c8a[_0x14bbfb(0x254)]||_0x319c8a[_0x14bbfb(0x146)]||0x0),_0x22a8b0=new Map();for(const _0x380042 of _0xfacdeb){const _0x107f07=_0x380042[_0x14bbfb(0x1a1)],_0x17d6df=_0x2fc678[_0x14bbfb(0x107)](Number,_0x380042[_0x14bbfb(0x26a)]||0x0),_0x2cde8c=_0x2fc678[_0x14bbfb(0x129)](_0x17d6df,_0x466e63),_0x458c70=Number(_0x107f07['Stock']||0x0),_0x2f4bf6=_0x458c70-_0x2cde8c;if(_0x2f4bf6<0x0)throw new Error('Stock\x20insuficiente\x20para\x20fragancia\x20'+_0x107f07[_0x14bbfb(0x1d2)]+'.\x20Disponible:\x20'+_0x458c70+',\x20Necesario:\x20'+_0x2cde8c+'\x20('+_0x17d6df+_0x14bbfb(0x26c)+_0x466e63+')');await _0x107f07[_0x14bbfb(0x20d)]({'Stock':_0x2f4bf6},{'transaction':_0x3a755c}),_0x22a8b0['set'](_0x107f07['Id_Insumos'],!![]);}for(const _0x3c69b8 of _0x4fc691){const _0x7e2604=_0x3c69b8['Id_Insumos_Insumo'];if(_0x22a8b0[_0x14bbfb(0x115)](_0x7e2604[_0x14bbfb(0x14a)]))continue;const _0x37dbfb=_0x2fc678[_0x14bbfb(0x1a8)](Number,_0x3c69b8['Cantidad']||0x0),_0x5773b9=_0x37dbfb*_0x466e63,_0x5136a2=Number(_0x7e2604[_0x14bbfb(0x19f)]||0x0),_0x38408b=_0x2fc678[_0x14bbfb(0x163)](_0x5136a2,_0x5773b9);if(_0x38408b<0x0)throw new Error(_0x14bbfb(0x24f)+_0x7e2604[_0x14bbfb(0x1d2)]+_0x14bbfb(0x1db)+_0x5136a2+',\x20Necesario:\x20'+_0x5773b9+'\x20('+_0x37dbfb+_0x14bbfb(0x26c)+_0x466e63+')');await _0x7e2604[_0x14bbfb(0x20d)]({'Stock':_0x38408b},{'transaction':_0x3a755c});}}};exports[a0_0x2178a1(0x119)]=async(_0x131d37,_0x4b43b7)=>{const _0x1847e6=a0_0x2178a1,_0x45bcf9={'yEBLX':_0x1847e6(0x16b),'sSEJk':'success','sEvli':'Error\x20al\x20verificar\x20insumos:','mplAU':_0x1847e6(0x21e)};try{const {idProducto:_0x257c3f,nombreTamano:_0x17d0c0}=_0x131d37['params'],_0x470fed=await Tamano[_0x1847e6(0x10b)]({'where':{'Nombre':_0x17d0c0}});if(!_0x470fed)return _0x4b43b7[_0x1847e6(0x1d7)](0x194)[_0x1847e6(0x1f2)]({'status':_0x45bcf9[_0x1847e6(0x17b)],'message':_0x1847e6(0x278)+_0x17d0c0+_0x1847e6(0x1b8)});const _0x366e1e=await Producto_Tamano['findOne']({'where':{'Id_Productos':_0x257c3f,'Id_Tamano':_0x470fed[_0x1847e6(0x112)]}});if(!_0x366e1e)return _0x4b43b7[_0x1847e6(0x1d7)](0x194)[_0x1847e6(0x1f2)]({'status':_0x45bcf9['yEBLX'],'message':_0x1847e6(0x139)+_0x257c3f+_0x1847e6(0x1f1)+_0x17d0c0+_0x1847e6(0x221)});const _0x5e2500=await Producto_Tamano_Insumos[_0x1847e6(0x205)]({'where':{'Id_Producto_Tamano':_0x366e1e[_0x1847e6(0x132)]},'include':[{'model':Insumos,'as':'Id_Insumos_Insumo'}]}),_0x80af75=_0x5e2500['map'](_0x2aaa88=>({'Id_Insumo':_0x2aaa88[_0x1847e6(0x1a1)][_0x1847e6(0x14a)],'Nombre':_0x2aaa88['Id_Insumos_Insumo'][_0x1847e6(0x1d2)],'Stock_Actual':_0x2aaa88[_0x1847e6(0x1a1)]['Stock'],'Cantidad_Consumo':_0x2aaa88[_0x1847e6(0x26a)],'Unidad_Medida':_0x2aaa88[_0x1847e6(0x1a1)][_0x1847e6(0x1ef)]}));_0x4b43b7[_0x1847e6(0x1f2)]({'status':_0x45bcf9[_0x1847e6(0x17d)],'message':_0x1847e6(0x1c1)+_0x257c3f+_0x1847e6(0x1ff)+_0x17d0c0,'data':{'Id_Producto':_0x257c3f,'Id_Tamano':_0x470fed['Id_Tamano'],'Nombre_Tamano':_0x17d0c0,'Id_Producto_Tamano':_0x366e1e[_0x1847e6(0x132)],'Total_Insumos':_0x80af75[_0x1847e6(0x1d4)],'Insumos':_0x80af75}});}catch(_0x346a1a){console[_0x1847e6(0x16b)](_0x45bcf9[_0x1847e6(0x1e2)],_0x346a1a),_0x4b43b7[_0x1847e6(0x1d7)](0x1f4)['json']({'status':_0x1847e6(0x16b),'message':_0x45bcf9[_0x1847e6(0x1e4)],'detail':_0x346a1a[_0x1847e6(0x1ee)]});}},exports[a0_0x2178a1(0x1c8)]=async(_0x478a86,_0x11e49)=>{const _0x336d6e=a0_0x2178a1,_0xf64978={'jUMsP':function(_0x254ea2,_0x19109f){return _0x254ea2>_0x19109f;},'qcZtD':function(_0xa0a001,_0x5f1707){return _0xa0a001(_0x5f1707);},'BKMBZ':'Detalle_Venta','WcLRo':_0x336d6e(0x117),'pvARB':_0x336d6e(0x213),'sacdZ':'Id_Agendamientos_Agendamiento','Xvoor':'Id_Empleados_Empleado','RHIfj':'Id_Empleados','VQGqc':'Nombre','aiiKK':_0x336d6e(0x100),'VRkYT':'error','YSNNC':function(_0x46cdd9,_0x10eda3){return _0x46cdd9===_0x10eda3;},'HOvxm':_0x336d6e(0x103)};try{const _0x1092e4=await Ventas[_0x336d6e(0x205)]({'include':[{'model':Detalle_Venta,'as':_0xf64978[_0x336d6e(0x27d)],'include':[{'model':Productos,'as':'Id_Productos_Producto'},{'model':Producto_Tallas,'as':_0xf64978[_0x336d6e(0x1be)]},{'model':Producto_Tamano_Insumos,'as':_0xf64978[_0x336d6e(0x20f)]},{'model':Servicios,'as':_0x336d6e(0x1da)}]},{'model':Agendamientos,'as':_0xf64978['sacdZ'],'required':![]},{'model':Empleados,'as':_0xf64978['Xvoor'],'attributes':[_0xf64978['RHIfj'],_0xf64978[_0x336d6e(0x217)]]}]}),_0x301f5f=_0x1092e4[_0x336d6e(0x25b)](_0x190531=>{const _0x1e3375=_0x336d6e,_0x42d2b7={'WaBSq':function(_0x5079f5,_0x566a28){const _0x323a2a=a0_0x1706;return _0xf64978[_0x323a2a(0x1b0)](_0x5079f5,_0x566a28);}},_0x5f3e2c=_0x190531[_0x1e3375(0x274)](),_0x580823=_0x5f3e2c['Detalle_Venta']||[],_0x48cecc=_0x5f3e2c['Id_Agendamientos_Agendamiento']||null,_0x392021=_0x5f3e2c[_0x1e3375(0x1b6)]||{},_0x302901=_0x580823['map'](_0x102ea8=>{const _0x1e93e0=_0x1e3375,_0x5c0a9a={..._0x102ea8};if(_0x102ea8[_0x1e93e0(0x276)])try{_0x5c0a9a[_0x1e93e0(0x212)]=JSON[_0x1e93e0(0x239)](_0x102ea8[_0x1e93e0(0x276)]);}catch(_0x4f9fd9){_0x5c0a9a[_0x1e93e0(0x212)]=[];}else _0x5c0a9a[_0x1e93e0(0x212)]=[];if(_0x102ea8['Tamanos_Data'])try{_0x5c0a9a[_0x1e93e0(0x23f)]=JSON[_0x1e93e0(0x239)](_0x102ea8[_0x1e93e0(0x10c)]);}catch(_0x1fabe2){_0x5c0a9a['Tamanos']=[];}else _0x5c0a9a[_0x1e93e0(0x23f)]=[];return _0x5c0a9a[_0x1e93e0(0x244)]=_0x5c0a9a['Tallas']&&_0x42d2b7['WaBSq'](_0x5c0a9a[_0x1e93e0(0x212)][_0x1e93e0(0x1d4)],0x0),_0x5c0a9a[_0x1e93e0(0x11b)]=_0x5c0a9a['Tamanos']&&_0x5c0a9a[_0x1e93e0(0x23f)]['length']>0x0,_0x5c0a9a[_0x1e93e0(0x244)]&&(_0x5c0a9a[_0x1e93e0(0x11f)]=_0x5c0a9a['Tallas'][_0x1e93e0(0x25b)](_0x306baa=>(_0x306baa[_0x1e93e0(0x146)]||_0x306baa['Cantidad']||0x0)+'\x20x\x20Talla\x20'+(_0x306baa[_0x1e93e0(0x1fa)]||_0x306baa[_0x1e93e0(0x23b)]||_0x306baa['nombre']||_0x1e93e0(0x15f)))['join'](',\x20')),_0x5c0a9a['tieneTamanos']&&(_0x5c0a9a[_0x1e93e0(0x1c0)]=_0x5c0a9a['Tamanos'][_0x1e93e0(0x25b)](_0x440eb5=>_0x440eb5[_0x1e93e0(0x254)]+_0x1e93e0(0x26c)+_0x440eb5['nombre'])[_0x1e93e0(0x22a)](',\x20')),_0x5c0a9a;}),_0xb4c930=_0x302901[_0x1e3375(0x1ac)]((_0x3b4756,_0x13364a)=>_0x3b4756+Number(_0x13364a[_0x1e3375(0x1b1)]||0x0),0x0),_0x2e8891=_0x48cecc?_0xf64978[_0x1e3375(0x12c)](Number,_0x48cecc[_0x1e3375(0x1b1)]||0x0):0x0,_0xb8854=_0xb4c930+_0x2e8891,_0xc4288a=Number(_0x5f3e2c[_0x1e3375(0x145)])===_0xb8854;return{'Id_Ventas':_0x5f3e2c[_0x1e3375(0x162)],'Id_Agendamientos':_0x5f3e2c[_0x1e3375(0x10e)],'Id_Cliente':_0x5f3e2c[_0x1e3375(0x105)],'Id_Empleados':_0x5f3e2c[_0x1e3375(0x270)],'Nombre_Empleado':_0x392021?.[_0x1e3375(0x1d2)]||'Desconocido','Fecha':_0x5f3e2c[_0x1e3375(0x11d)],'Total':_0x5f3e2c[_0x1e3375(0x145)],'Estado':_0x5f3e2c[_0x1e3375(0x266)],'M_Pago':_0x5f3e2c[_0x1e3375(0x14b)],'Referencia':_0x5f3e2c[_0x1e3375(0x24a)],'Detalle_Venta':_0x302901,'tieneAgendamiento':!!_0x5f3e2c[_0x1e3375(0x10e)],'Agendamiento':_0x48cecc,'totalValidado':_0xc4288a};});_0x11e49[_0x336d6e(0x1f2)]({'status':'success','data':_0x301f5f});}catch(_0x35efd7){console[_0x336d6e(0x16b)](_0xf64978[_0x336d6e(0x256)],_0x35efd7),_0x11e49['status'](0x1f4)['json']({'status':_0xf64978['VRkYT'],'message':_0xf64978[_0x336d6e(0x110)](process[_0x336d6e(0x154)]['NODE_ENV'],'development')?'Error\x20al\x20obtener\x20ventas:\x20'+_0x35efd7['message']:_0xf64978[_0x336d6e(0x23c)]});}},exports[a0_0x2178a1(0x1ce)]=async(_0x439669,_0x4dba51)=>{const _0x3773e3=a0_0x2178a1,_0x4fb276={'pWteg':function(_0x1b6e33,_0x24a2c5){return _0x1b6e33>_0x24a2c5;},'NQfdX':function(_0x3bdf83,_0x60b366){return _0x3bdf83>_0x60b366;},'JvjVA':_0x3773e3(0x150),'wVnJr':_0x3773e3(0x201),'SmQnT':'Id_Producto_Tallas_Producto_Talla','CaZto':_0x3773e3(0x1da),'ojIDm':_0x3773e3(0x16e),'lOgel':_0x3773e3(0x1b6),'NewMg':_0x3773e3(0x16b),'SlGhr':'Venta\x20no\x20encontrada','XGZWO':function(_0x335ad9,_0x1545ef){return _0x335ad9(_0x1545ef);},'izPTF':function(_0x35e35f,_0xb79d1e){return _0x35e35f+_0xb79d1e;},'HRJox':function(_0x21dd45,_0x244d7d){return _0x21dd45===_0x244d7d;},'vkWsT':_0x3773e3(0xfe),'XfMZW':'Desconocido','XLmoA':_0x3773e3(0x1bc),'jgcoB':_0x3773e3(0x13e)};try{const {id:_0x3c486c}=_0x439669[_0x3773e3(0x26d)],_0x3722ed=await Ventas[_0x3773e3(0x211)](_0x3c486c,{'include':[{'model':Detalle_Venta,'as':_0x4fb276[_0x3773e3(0x144)],'include':[{'model':Productos,'as':_0x4fb276[_0x3773e3(0x238)]},{'model':Producto_Tallas,'as':_0x4fb276[_0x3773e3(0x1e5)]},{'model':Producto_Tamano_Insumos,'as':_0x3773e3(0x213)},{'model':Servicios,'as':_0x4fb276['CaZto']}]},{'model':Agendamientos,'as':_0x4fb276[_0x3773e3(0x22d)],'required':![]},{'model':Empleados,'as':_0x4fb276['lOgel'],'attributes':[_0x3773e3(0x1d2)]}]});if(!_0x3722ed)return _0x4dba51['status'](0x194)[_0x3773e3(0x1f2)]({'status':_0x4fb276[_0x3773e3(0x1d5)],'message':_0x4fb276['SlGhr']});const _0x206f0d=_0x3722ed[_0x3773e3(0x274)](),_0x471ab3=_0x206f0d[_0x3773e3(0x150)]||[],_0x87fb36=_0x206f0d['Id_Agendamientos_Agendamiento']||null,_0x40600e=_0x206f0d[_0x3773e3(0x1b6)]||{},_0x3f79dc=_0x471ab3[_0x3773e3(0x25b)](_0x4a2887=>{const _0x258307=_0x3773e3,_0x4d7f48={..._0x4a2887};if(_0x4a2887[_0x258307(0x276)])try{_0x4d7f48[_0x258307(0x212)]=JSON['parse'](_0x4a2887[_0x258307(0x276)]);}catch(_0x4f86c7){_0x4d7f48[_0x258307(0x212)]=[];}else _0x4d7f48['Tallas']=[];if(_0x4a2887['Tamanos_Data'])try{_0x4d7f48['Tamanos']=JSON[_0x258307(0x239)](_0x4a2887[_0x258307(0x10c)]);}catch(_0x2cda4b){_0x4d7f48['Tamanos']=[];}else _0x4d7f48['Tamanos']=[];return _0x4d7f48[_0x258307(0x244)]=_0x4d7f48['Tallas']&&_0x4fb276[_0x258307(0x1ae)](_0x4d7f48['Tallas']['length'],0x0),_0x4d7f48['tieneTamanos']=_0x4d7f48['Tamanos']&&_0x4fb276[_0x258307(0x190)](_0x4d7f48[_0x258307(0x23f)]['length'],0x0),_0x4d7f48['tieneTallas']&&(_0x4d7f48[_0x258307(0x11f)]=_0x4d7f48[_0x258307(0x212)][_0x258307(0x25b)](_0x38aa95=>(_0x38aa95['cantidad']||_0x38aa95['Cantidad']||0x0)+_0x258307(0x200)+(_0x38aa95[_0x258307(0x1fa)]||_0x38aa95[_0x258307(0x23b)]||_0x38aa95[_0x258307(0x207)]||_0x258307(0x15f)))[_0x258307(0x22a)](',\x20')),_0x4d7f48[_0x258307(0x11b)]&&(_0x4d7f48['descripcionTamanos']=_0x4d7f48[_0x258307(0x23f)][_0x258307(0x25b)](_0x16b0b5=>_0x16b0b5[_0x258307(0x254)]+'\x20x\x20'+_0x16b0b5[_0x258307(0x207)])[_0x258307(0x22a)](',\x20')),_0x4d7f48;}),_0x346f6f=_0x3f79dc['reduce']((_0x48e3d8,_0x407267)=>_0x48e3d8+Number(_0x407267[_0x3773e3(0x1b1)]||0x0),0x0),_0x5f0f8b=_0x87fb36?_0x4fb276[_0x3773e3(0x12a)](Number,_0x87fb36[_0x3773e3(0x1b1)]||0x0):0x0,_0x355916=_0x4fb276[_0x3773e3(0x259)](_0x346f6f,_0x5f0f8b),_0x21106d=_0x4fb276[_0x3773e3(0x194)](_0x4fb276[_0x3773e3(0x12a)](Number,_0x206f0d['Total']),_0x355916);_0x4dba51[_0x3773e3(0x1f2)]({'status':_0x4fb276['vkWsT'],'data':{'Id_Ventas':_0x206f0d[_0x3773e3(0x162)],'Id_Agendamientos':_0x206f0d[_0x3773e3(0x10e)],'Id_Cliente':_0x206f0d[_0x3773e3(0x105)],'Id_Empleados':_0x206f0d['Id_Empleados'],'Nombre_Empleado':_0x40600e?.['Nombre']||_0x4fb276[_0x3773e3(0x151)],'Fecha':_0x206f0d[_0x3773e3(0x11d)],'Total':_0x206f0d[_0x3773e3(0x145)],'M_Pago':_0x206f0d['M_Pago'],'Referencia':_0x206f0d[_0x3773e3(0x24a)],'Estado':_0x206f0d['Estado'],'Detalle_Venta':_0x3f79dc,'tieneAgendamiento':!!_0x206f0d['Id_Agendamientos'],'Agendamiento':_0x87fb36,'totalValidado':_0x21106d}});}catch(_0x3bb11a){console['error'](_0x4fb276[_0x3773e3(0x24b)],_0x3bb11a),_0x4dba51[_0x3773e3(0x1d7)](0x1f4)['json']({'status':_0x4fb276[_0x3773e3(0x1d5)],'message':_0x4fb276[_0x3773e3(0x27c)]});}},exports['crearVenta']=async(_0xa83b2,_0x14a742)=>{const _0x23b9a9=a0_0x2178a1,_0x515441={'qCILk':function(_0x27751d,_0x52ebf2){return _0x27751d===_0x52ebf2;},'Zbqoo':'string','rTXvY':function(_0x39172a,_0x82d84){return _0x39172a||_0x82d84;},'tPHQt':'error','iddbg':_0x23b9a9(0x19a),'nMqgd':function(_0xb7e10e,_0x4dc8a2,_0x24923c){return _0xb7e10e(_0x4dc8a2,_0x24923c);},'tlIxe':function(_0x4f7000,_0x1f7455,_0x44f19f){return _0x4f7000(_0x1f7455,_0x44f19f);},'FOPxP':function(_0x56a90a,_0x538763,_0x2eb4c5){return _0x56a90a(_0x538763,_0x2eb4c5);},'UxQNf':_0x23b9a9(0x193),'pDoKy':function(_0xd63ddc,_0xbd1fc3){return _0xd63ddc(_0xbd1fc3);},'RBlwX':'Id_Productos','XzNbH':'Precio_Venta','xaMxj':'Stock','DOasu':function(_0x2a7c65,_0x31720d){return _0x2a7c65>_0x31720d;},'zLEbz':_0x23b9a9(0x1a1),'cxrRC':function(_0x3fd874,_0x1d6d42){return _0x3fd874(_0x1d6d42);},'QaiAw':function(_0xafe7c7,_0x35b013){return _0xafe7c7*_0x35b013;},'zDYon':function(_0x545fb8,_0x13101f){return _0x545fb8(_0x13101f);},'MpHQP':function(_0x5dc1f7,_0x10cacb){return _0x5dc1f7<_0x10cacb;},'AZIFP':function(_0x37ffd9,_0x2aa730){return _0x37ffd9(_0x2aa730);},'hHjme':function(_0x2aa81a,_0x58605a){return _0x2aa81a*_0x58605a;},'bxDhH':function(_0x1a8f84,_0x123b64){return _0x1a8f84(_0x123b64);},'pHrKH':function(_0x1a213b,_0x57efb4){return _0x1a213b<_0x57efb4;},'wNeDZ':'Id_Tallas_Talla','vSKuG':_0x23b9a9(0x1d2),'Ziqsx':function(_0x827799,_0x1f9509){return _0x827799(_0x1f9509);},'iVbti':function(_0x3757e8,_0x484dc9){return _0x3757e8>_0x484dc9;},'TxhxY':function(_0x2d69fc,_0x5944fa,_0x526721,_0x101a00,_0x56a72f,_0x946754){return _0x2d69fc(_0x5944fa,_0x526721,_0x101a00,_0x56a72f,_0x946754);},'TEITQ':function(_0x13d67b,_0x26e40a){return _0x13d67b+_0x26e40a;},'kKWol':function(_0x49f795,_0x2dc6db){return _0x49f795>_0x2dc6db;},'NahKs':function(_0x406539,_0x31086c){return _0x406539>_0x31086c;},'TCYhg':function(_0xf8346a,_0x447760,_0x146172,_0x525d7c){return _0xf8346a(_0x447760,_0x146172,_0x525d7c);},'NcKIN':function(_0x1d8b31,_0x55fa33){return _0x1d8b31>_0x55fa33;},'gsxAo':function(_0x236fe5,_0x4d206e,_0xad5b5,_0x1e20da){return _0x236fe5(_0x4d206e,_0xad5b5,_0x1e20da);},'Myhll':'success','OpoYB':_0x23b9a9(0x1f3),'ormqY':_0x23b9a9(0x1f9),'mZTdM':function(_0x471b9d,_0x5a77ff){return _0x471b9d instanceof _0x5a77ff;},'beqjX':_0x23b9a9(0x14d),'OSagb':function(_0x4f0e32,_0xb45cdf){return _0x4f0e32 instanceof _0xb45cdf;},'cSYuG':_0x23b9a9(0x26b),'FnRKd':_0x23b9a9(0x223),'EEAzi':_0x23b9a9(0x1e1),'iKotN':'insuficiente','tkeQe':_0x23b9a9(0x268),'owOZQ':'Error\x20de\x20validación'},_0x32d250=await sequelize['transaction']();try{const {Id_Agendamientos:_0x59b496,Id_Cliente:_0x4629d7,Id_Empleados:_0x543e14,Fecha:_0x382ebd,M_Pago:_0x509bce,Referencia:_0x5ee388,Estado:Estado=0x3,Detalle_Venta:_0x1005dd=[]}=_0xa83b2['body'];if(_0x515441[_0x23b9a9(0x22c)](!_0x4629d7,!_0x543e14)||!_0x382ebd||!_0x509bce||_0x515441[_0x23b9a9(0x197)](_0x1005dd[_0x23b9a9(0x1d4)],0x0))return await _0x32d250[_0x23b9a9(0x25f)](),_0x14a742[_0x23b9a9(0x1d7)](0x190)['json']({'status':_0x515441['tPHQt'],'message':_0x515441[_0x23b9a9(0x15d)],'required':{'Id_Cliente':_0x4629d7,'Id_Empleados':_0x543e14,'Fecha':_0x382ebd,'M_Pago':_0x509bce,'Detalles':_0x1005dd[_0x23b9a9(0x1d4)]}});await _0x515441['nMqgd'](validarCliente,_0x4629d7,_0x32d250),await _0x515441[_0x23b9a9(0x245)](validarEmpleado,_0x543e14,_0x32d250),_0x515441[_0x23b9a9(0x13f)](validarMetodoPago,_0x509bce,_0x5ee388);let _0x97710c=0x0;if(_0x59b496){const _0x2553bd=await Agendamientos['findByPk'](_0x59b496,{'transaction':_0x32d250});if(!_0x2553bd)return await _0x32d250[_0x23b9a9(0x25f)](),_0x14a742[_0x23b9a9(0x1d7)](0x190)['json']({'status':_0x23b9a9(0x16b),'message':_0x515441['UxQNf']});_0x97710c=_0x515441[_0x23b9a9(0x240)](Number,_0x2553bd[_0x23b9a9(0x1b1)]||0x0);}let _0x33d8bb=0x0;const _0x50f237=[];for(const _0x12dad1 of _0x1005dd){const _0x2cace4=await Productos['findByPk'](_0x12dad1['Id_Productos'],{'transaction':_0x32d250,'attributes':[_0x515441[_0x23b9a9(0x1c9)],_0x23b9a9(0x1d2),_0x515441['XzNbH'],_0x515441[_0x23b9a9(0x158)]]});if(!_0x2cace4)return await _0x32d250[_0x23b9a9(0x25f)](),_0x14a742[_0x23b9a9(0x1d7)](0x190)['json']({'status':_0x23b9a9(0x16b),'message':_0x23b9a9(0x21f)+_0x12dad1[_0x23b9a9(0x165)]+_0x23b9a9(0x1b8)});let _0xb51609=_0x12dad1['Tallas']||[],_0x4a53db=_0x12dad1[_0x23b9a9(0x23f)]||[];if(_0x12dad1[_0x23b9a9(0x10c)]&&typeof _0x12dad1[_0x23b9a9(0x10c)]===_0x515441[_0x23b9a9(0x1bd)])try{_0x4a53db=JSON[_0x23b9a9(0x239)](_0x12dad1[_0x23b9a9(0x10c)]);}catch(_0x1c7242){_0x4a53db=[];}else _0x12dad1[_0x23b9a9(0x10c)]&&Array[_0x23b9a9(0x204)](_0x12dad1['Tamanos_Data'])&&(_0x4a53db=_0x12dad1[_0x23b9a9(0x10c)]);if(_0x12dad1['Tallas_Data']&&_0x515441['qCILk'](typeof _0x12dad1[_0x23b9a9(0x276)],_0x515441[_0x23b9a9(0x1bd)]))try{_0xb51609=JSON['parse'](_0x12dad1[_0x23b9a9(0x276)]);}catch(_0x5aee90){_0xb51609=[];}else _0x12dad1[_0x23b9a9(0x276)]&&Array[_0x23b9a9(0x204)](_0x12dad1[_0x23b9a9(0x276)])&&(_0xb51609=_0x12dad1[_0x23b9a9(0x276)]);try{if(_0x4a53db&&_0x515441[_0x23b9a9(0x12f)](_0x4a53db['length'],0x0))for(const _0x28ee9f of _0x4a53db){const _0x15cec8=_0x28ee9f['nombre']||_0x28ee9f[_0x23b9a9(0x1d2)]||'';if(!_0x15cec8)return await _0x32d250['rollback'](),_0x14a742[_0x23b9a9(0x1d7)](0x190)[_0x23b9a9(0x1f2)]({'status':_0x515441[_0x23b9a9(0x130)],'message':_0x23b9a9(0x25c)+_0x2cace4['Nombre']});const _0x16d925=await Tamano[_0x23b9a9(0x10b)]({'where':{'Nombre':_0x15cec8},'transaction':_0x32d250});if(!_0x16d925)return await _0x32d250[_0x23b9a9(0x25f)](),_0x14a742[_0x23b9a9(0x1d7)](0x190)['json']({'status':_0x23b9a9(0x16b),'message':_0x23b9a9(0x278)+_0x15cec8+_0x23b9a9(0x1b8)});const _0x50e2ca=await Producto_Tamano['findOne']({'where':{'Id_Productos':_0x12dad1['Id_Productos'],'Id_Tamano':_0x16d925[_0x23b9a9(0x112)]},'transaction':_0x32d250});if(!_0x50e2ca)return await _0x32d250[_0x23b9a9(0x25f)](),_0x14a742[_0x23b9a9(0x1d7)](0x190)['json']({'status':_0x515441[_0x23b9a9(0x130)],'message':_0x23b9a9(0x139)+_0x2cace4[_0x23b9a9(0x1d2)]+'\x20no\x20tiene\x20el\x20tamaño\x20'+_0x15cec8+_0x23b9a9(0x221)});const _0x2201f7=await Producto_Tamano_Insumos[_0x23b9a9(0x205)]({'where':{'Id_Producto_Tamano':_0x50e2ca[_0x23b9a9(0x132)]},'include':[{'model':Insumos,'as':_0x515441['zLEbz']}],'transaction':_0x32d250}),_0x1187cb=await Tamano_Insumos[_0x23b9a9(0x205)]({'where':{'Id_Tamano':_0x16d925[_0x23b9a9(0x112)]},'include':[{'model':Insumos,'as':_0x515441[_0x23b9a9(0x164)]}],'transaction':_0x32d250}),_0x3b4975=_0x515441['pDoKy'](Number,_0x28ee9f[_0x23b9a9(0x254)]||_0x28ee9f[_0x23b9a9(0x146)]||0x0),_0x12de62=new Map();for(const _0x4e8709 of _0x2201f7){const _0x2f8649=_0x4e8709[_0x23b9a9(0x1a1)],_0x266e29=_0x515441[_0x23b9a9(0x185)](Number,_0x4e8709[_0x23b9a9(0x26a)]||0x0),_0x1c321a=_0x515441[_0x23b9a9(0x20c)](_0x266e29,_0x3b4975),_0x5791a3=_0x515441[_0x23b9a9(0x222)](Number,_0x2f8649[_0x23b9a9(0x19f)]||0x0);if(_0x515441[_0x23b9a9(0x1eb)](_0x5791a3,_0x1c321a))return await _0x32d250[_0x23b9a9(0x25f)](),_0x14a742[_0x23b9a9(0x1d7)](0x190)[_0x23b9a9(0x1f2)]({'status':_0x515441[_0x23b9a9(0x130)],'message':'Stock\x20insuficiente\x20para\x20fragancia\x20'+_0x2f8649[_0x23b9a9(0x1d2)]+'.\x20Disponible:\x20'+_0x5791a3+_0x23b9a9(0x143)+_0x1c321a});_0x12de62[_0x23b9a9(0x253)](_0x2f8649[_0x23b9a9(0x14a)],!![]);}for(const _0x2170af of _0x1187cb){const _0x23300e=_0x2170af[_0x23b9a9(0x1a1)];if(_0x12de62[_0x23b9a9(0x115)](_0x23300e[_0x23b9a9(0x14a)]))continue;const _0x4c7bae=_0x515441[_0x23b9a9(0x1a9)](Number,_0x2170af[_0x23b9a9(0x254)]||0x0),_0x4a672d=_0x515441[_0x23b9a9(0x152)](_0x4c7bae,_0x3b4975),_0x299663=_0x515441[_0x23b9a9(0x222)](Number,_0x23300e[_0x23b9a9(0x19f)]||0x0);if(_0x515441[_0x23b9a9(0x1eb)](_0x299663,_0x4a672d))return await _0x32d250[_0x23b9a9(0x25f)](),_0x14a742[_0x23b9a9(0x1d7)](0x190)[_0x23b9a9(0x1f2)]({'status':_0x515441[_0x23b9a9(0x130)],'message':_0x23b9a9(0x24f)+_0x23300e[_0x23b9a9(0x1d2)]+_0x23b9a9(0x1db)+_0x299663+_0x23b9a9(0x143)+_0x4a672d});}}else{if(_0xb51609&&_0xb51609[_0x23b9a9(0x1d4)]>0x0){let _0x1e7767=0x0;for(const _0x2ae54a of _0xb51609){const _0x1720f7=_0x2ae54a[_0x23b9a9(0x1fa)]||_0x2ae54a[_0x23b9a9(0x23b)]||_0x2ae54a['nombre']||'',_0x372a01=_0x515441[_0x23b9a9(0x192)](Number,_0x2ae54a[_0x23b9a9(0x146)]||_0x2ae54a[_0x23b9a9(0x254)]||0x0);if(!_0x1720f7)return await _0x32d250['rollback'](),_0x14a742[_0x23b9a9(0x1d7)](0x190)['json']({'status':_0x23b9a9(0x16b),'message':_0x23b9a9(0x1cd)+_0x2cace4[_0x23b9a9(0x1d2)]});const _0x5bae58=await Tallas['findOne']({'where':{'Nombre':_0x1720f7},'transaction':_0x32d250});if(!_0x5bae58)return await _0x32d250[_0x23b9a9(0x25f)](),_0x14a742[_0x23b9a9(0x1d7)](0x190)[_0x23b9a9(0x1f2)]({'status':_0x515441[_0x23b9a9(0x130)],'message':_0x23b9a9(0x1e6)+_0x1720f7+'\x20no\x20encontrada'});const _0x3c150e=await Producto_Tallas['findOne']({'where':{'Id_Productos':_0x12dad1[_0x23b9a9(0x165)],'Id_Tallas':_0x5bae58[_0x23b9a9(0x147)]},'transaction':_0x32d250});if(!_0x3c150e)return await _0x32d250[_0x23b9a9(0x25f)](),_0x14a742[_0x23b9a9(0x1d7)](0x190)[_0x23b9a9(0x1f2)]({'status':_0x515441[_0x23b9a9(0x130)],'message':_0x23b9a9(0x1e6)+_0x1720f7+_0x23b9a9(0x1fd)+_0x2cace4[_0x23b9a9(0x1d2)]});const _0x579ba9=_0x515441['zDYon'](Number,_0x3c150e['Stock']||0x0);if(_0x515441[_0x23b9a9(0x1eb)](_0x579ba9,_0x372a01))return await _0x32d250[_0x23b9a9(0x25f)](),_0x14a742[_0x23b9a9(0x1d7)](0x190)['json']({'status':_0x515441[_0x23b9a9(0x130)],'message':'Stock\x20insuficiente\x20para\x20talla\x20'+_0x1720f7+'\x20del\x20producto\x20'+_0x2cace4[_0x23b9a9(0x1d2)]+_0x23b9a9(0x1db)+_0x579ba9+',\x20Solicitado:\x20'+_0x372a01});_0x1e7767+=_0x372a01;}const _0x14b6a4=_0x515441['AZIFP'](Number,_0x2cace4[_0x23b9a9(0x19f)]||0x0);if(_0x515441[_0x23b9a9(0x167)](_0x14b6a4,_0x1e7767))return await _0x32d250[_0x23b9a9(0x25f)](),_0x14a742[_0x23b9a9(0x1d7)](0x190)[_0x23b9a9(0x1f2)]({'status':_0x515441['tPHQt'],'message':_0x23b9a9(0x13c)+_0x2cace4[_0x23b9a9(0x1d2)]+_0x23b9a9(0x1db)+_0x14b6a4+',\x20Solicitado:\x20'+_0x1e7767});}else{const _0x5b762c=await Producto_Tallas['findAll']({'where':{'Id_Productos':_0x12dad1[_0x23b9a9(0x165)]},'include':[{'model':Tallas,'as':_0x515441['wNeDZ'],'attributes':[_0x23b9a9(0x147),_0x515441[_0x23b9a9(0xfb)]]}],'transaction':_0x32d250});if(_0x5b762c&&_0x515441[_0x23b9a9(0x12f)](_0x5b762c[_0x23b9a9(0x1d4)],0x0))return await _0x32d250[_0x23b9a9(0x25f)](),_0x14a742[_0x23b9a9(0x1d7)](0x190)['json']({'status':_0x23b9a9(0x16b),'message':'El\x20producto\x20'+_0x2cace4['Nombre']+_0x23b9a9(0x1e3)+_0x5b762c[_0x23b9a9(0x25b)](_0xd827bf=>_0xd827bf[_0x23b9a9(0x177)]?.[_0x23b9a9(0x1d2)]||_0x23b9a9(0x15f))[_0x23b9a9(0x22a)](',\x20')});const _0x1bb0be=_0x515441['Ziqsx'](Number,_0x2cace4[_0x23b9a9(0x19f)]||0x0),_0x2b9edb=_0x515441[_0x23b9a9(0x192)](Number,_0x12dad1['Cantidad']||0x0);if(_0x515441['pHrKH'](_0x1bb0be,_0x2b9edb))return await _0x32d250[_0x23b9a9(0x25f)](),_0x14a742[_0x23b9a9(0x1d7)](0x190)['json']({'status':_0x515441[_0x23b9a9(0x130)],'message':_0x23b9a9(0x172)+_0x2cace4[_0x23b9a9(0x1d2)]+_0x23b9a9(0x1db)+_0x1bb0be+_0x23b9a9(0x106)+_0x2b9edb});}}}catch(_0x4b7ca1){return await _0x32d250[_0x23b9a9(0x25f)](),_0x14a742[_0x23b9a9(0x1d7)](0x190)[_0x23b9a9(0x1f2)]({'status':_0x515441['tPHQt'],'message':'Error\x20al\x20validar\x20stock:\x20'+_0x4b7ca1[_0x23b9a9(0x1ee)]});}if(_0x12dad1[_0x23b9a9(0x10c)]&&typeof _0x12dad1[_0x23b9a9(0x10c)]===_0x515441[_0x23b9a9(0x1bd)])try{_0x4a53db=JSON[_0x23b9a9(0x239)](_0x12dad1[_0x23b9a9(0x10c)]);}catch(_0x325b3c){_0x4a53db=[];}else _0x12dad1['Tamanos_Data']&&Array[_0x23b9a9(0x204)](_0x12dad1[_0x23b9a9(0x10c)])&&(_0x4a53db=_0x12dad1[_0x23b9a9(0x10c)]);if(_0x12dad1['Tallas_Data']&&_0x515441[_0x23b9a9(0x197)](typeof _0x12dad1[_0x23b9a9(0x276)],_0x515441[_0x23b9a9(0x1bd)]))try{_0xb51609=JSON['parse'](_0x12dad1[_0x23b9a9(0x276)]);}catch(_0x40292a){_0xb51609=[];}else _0x12dad1[_0x23b9a9(0x276)]&&Array[_0x23b9a9(0x204)](_0x12dad1[_0x23b9a9(0x276)])&&(_0xb51609=_0x12dad1[_0x23b9a9(0x276)]);_0xb51609&&_0x515441[_0x23b9a9(0x120)](_0xb51609[_0x23b9a9(0x1d4)],0x0)&&(_0xb51609=_0xb51609[_0x23b9a9(0x25b)](_0x259a89=>{const _0x203194=_0x23b9a9;if(_0x515441['qCILk'](typeof _0x259a89,_0x515441['Zbqoo']))return{'talla':_0x259a89,'cantidad':0x1,'precio':0x0};return{'talla':_0x259a89[_0x203194(0x1fa)]||_0x259a89[_0x203194(0x23b)]||_0x259a89[_0x203194(0x207)]||'','cantidad':_0x259a89[_0x203194(0x146)]||_0x259a89[_0x203194(0x254)]||0x1,'precio':_0x259a89[_0x203194(0x283)]||_0x259a89[_0x203194(0x267)]||0x0,'Id_Producto_Tallas':_0x259a89['Id_Producto_Tallas']||null};})['filter'](_0x76e64d=>_0x76e64d[_0x23b9a9(0x1fa)]&&_0x76e64d[_0x23b9a9(0x1fa)][_0x23b9a9(0x181)]()!==''));const _0x118d4a=await _0x515441[_0x23b9a9(0x16d)](calcularPrecio,_0x2cace4,_0xb51609,_0x4a53db,_0x12dad1[_0x23b9a9(0x254)],_0x32d250),_0x366ba1=_0x118d4a;_0x50f237['push']({..._0x12dad1,'Precio':_0x118d4a,'Subtotal':_0x366ba1,'Tallas':_0xb51609,'Tamanos':_0x4a53db,'Tallas_Original':_0x12dad1[_0x23b9a9(0x212)]||[],'Tamanos_Original':_0x12dad1[_0x23b9a9(0x23f)]||[],'Tallas_Data_Original':_0x12dad1[_0x23b9a9(0x276)],'Tamanos_Data_Original':_0x12dad1['Tamanos_Data']}),_0x33d8bb+=_0x366ba1;}const _0x39ffa8=_0x515441['TEITQ'](_0x33d8bb,_0x97710c),_0x337d96=await Ventas[_0x23b9a9(0x272)]({'Id_Agendamientos':_0x515441[_0x23b9a9(0x22c)](_0x59b496,null),'Id_Cliente':_0x4629d7,'Id_Empleados':_0x543e14,'Fecha':_0x382ebd,'Total':_0x39ffa8,'Estado':Estado,'M_Pago':_0x509bce,'Referencia':_0x5ee388||null},{'transaction':_0x32d250});for(const _0x28a843 of _0x50f237){let _0x58f301=[],_0x42c65d=[];if(_0x28a843[_0x23b9a9(0x1df)]&&typeof _0x28a843[_0x23b9a9(0x1df)]===_0x515441[_0x23b9a9(0x1bd)])try{_0x58f301=JSON[_0x23b9a9(0x239)](_0x28a843[_0x23b9a9(0x1df)]);}catch(_0x407895){_0x58f301=_0x28a843[_0x23b9a9(0x22b)]||[];}else _0x28a843[_0x23b9a9(0x22b)]&&_0x28a843['Tallas_Original'][_0x23b9a9(0x1d4)]>0x0?_0x58f301=_0x28a843[_0x23b9a9(0x22b)]:_0x58f301=_0x28a843[_0x23b9a9(0x212)]||[];if(_0x28a843[_0x23b9a9(0x123)]&&_0x515441[_0x23b9a9(0x197)](typeof _0x28a843[_0x23b9a9(0x123)],_0x515441[_0x23b9a9(0x1bd)]))try{_0x42c65d=JSON[_0x23b9a9(0x239)](_0x28a843[_0x23b9a9(0x123)]);}catch(_0x185402){_0x42c65d=_0x28a843['Tamanos_Original']||[];}else _0x28a843['Tamanos_Original']&&_0x515441['DOasu'](_0x28a843[_0x23b9a9(0x11a)][_0x23b9a9(0x1d4)],0x0)?_0x42c65d=_0x28a843[_0x23b9a9(0x11a)]:_0x42c65d=_0x28a843[_0x23b9a9(0x23f)]||[];_0x42c65d&&_0x42c65d[_0x23b9a9(0x1d4)]>0x0&&(_0x42c65d=_0x42c65d['map'](_0x1a2f9b=>({..._0x1a2f9b,'PrecioTotal':Number(_0x1a2f9b['PrecioTotal']||0x0)})));_0x58f301&&_0x515441[_0x23b9a9(0x12f)](_0x58f301[_0x23b9a9(0x1d4)],0x0)&&(_0x58f301=_0x58f301[_0x23b9a9(0x25b)](_0x390389=>{const _0x319268=_0x23b9a9,_0x14f556={..._0x390389,'talla':_0x390389[_0x319268(0x1fa)]||_0x390389[_0x319268(0x23b)]||_0x390389[_0x319268(0x207)]||'','cantidad':_0x390389['cantidad']||_0x390389['Cantidad']||0x0,'precio':_0x390389[_0x319268(0x283)]||_0x390389[_0x319268(0x267)]||0x0,'descripcion':_0x390389['descripcion']||(_0x390389[_0x319268(0x146)]||_0x390389[_0x319268(0x254)]||0x0)+_0x319268(0x200)+(_0x390389['talla']||_0x390389[_0x319268(0x23b)]||_0x390389['nombre']||''),'detalleTalla':_0x390389[_0x319268(0x219)]||'Talla\x20'+(_0x390389[_0x319268(0x1fa)]||_0x390389[_0x319268(0x23b)]||_0x390389[_0x319268(0x207)]||'')+':\x20'+(_0x390389[_0x319268(0x146)]||_0x390389[_0x319268(0x254)]||0x0)+'\x20unidades'};return delete _0x14f556[_0x319268(0x254)],delete _0x14f556[_0x319268(0x23b)],delete _0x14f556[_0x319268(0x267)],_0x14f556;})[_0x23b9a9(0x203)](_0xde30dd=>_0xde30dd[_0x23b9a9(0x1fa)]&&_0xde30dd[_0x23b9a9(0x1fa)][_0x23b9a9(0x181)]()!==''));const _0x50436a=_0x58f301&&_0x515441[_0x23b9a9(0x10f)](_0x58f301['length'],0x0)?JSON['stringify'](_0x58f301):null,_0xbda8f6=_0x42c65d&&_0x515441[_0x23b9a9(0x12f)](_0x42c65d['length'],0x0)?JSON[_0x23b9a9(0xfd)](_0x42c65d):null,_0xe06419={'Id_Ventas':_0x337d96[_0x23b9a9(0x162)],'Id_Productos':_0x28a843[_0x23b9a9(0x165)]||null,'Id_Servicios':_0x28a843[_0x23b9a9(0x17c)]||null,'Id_Producto_Tallas':_0x515441[_0x23b9a9(0x21a)](_0x58f301[_0x23b9a9(0x1d4)],0x0)?_0x58f301[0x0]['Id_Producto_Tallas']:null,'Id_Producto_Tamano_Insumos':_0x515441[_0x23b9a9(0x12f)](_0x42c65d[_0x23b9a9(0x1d4)],0x0)?_0x42c65d[0x0][_0x23b9a9(0x281)]:null,'Cantidad':_0x28a843[_0x23b9a9(0x254)],'Precio':_0x28a843[_0x23b9a9(0x267)],'Subtotal':_0x28a843[_0x23b9a9(0x1b1)]};if(_0x50436a)_0xe06419[_0x23b9a9(0x276)]=_0x50436a;if(_0xbda8f6)_0xe06419[_0x23b9a9(0x10c)]=_0xbda8f6;const _0x5384f7=await Detalle_Venta['create'](_0xe06419,{'transaction':_0x32d250});}for(const _0x12da78 of _0x50f237){const _0x1c7483=_0x12da78[_0x23b9a9(0x212)]||[],_0x2700ca=_0x12da78[_0x23b9a9(0x23f)]||[];try{if(_0x2700ca&&_0x515441[_0x23b9a9(0x10f)](_0x2700ca['length'],0x0))await _0x515441[_0x23b9a9(0x124)](actualizarStockInsumos,_0x12da78[_0x23b9a9(0x165)],_0x2700ca,_0x32d250);else _0x1c7483&&_0x515441[_0x23b9a9(0x13d)](_0x1c7483[_0x23b9a9(0x1d4)],0x0)?await _0x515441[_0x23b9a9(0x252)](actualizarStockTallas,_0x12da78[_0x23b9a9(0x165)],_0x1c7483,_0x32d250):await _0x515441[_0x23b9a9(0x124)](actualizarStockProducto,_0x12da78[_0x23b9a9(0x165)],_0x12da78['Cantidad'],_0x32d250);}catch(_0x35e835){return await _0x32d250['rollback'](),_0x14a742[_0x23b9a9(0x1d7)](0x190)[_0x23b9a9(0x1f2)]({'status':_0x515441['tPHQt'],'message':'Error\x20al\x20actualizar\x20stock:\x20'+_0x35e835['message']});}}await _0x32d250['commit'](),_0x14a742[_0x23b9a9(0x1d7)](0xc9)[_0x23b9a9(0x1f2)]({'status':_0x515441[_0x23b9a9(0x184)],'message':_0x515441[_0x23b9a9(0x183)],'data':{'Id_Ventas':_0x337d96[_0x23b9a9(0x162)],'Total':_0x39ffa8,'totalValidado':!![],'Detalle_Venta':_0x50f237}});}catch(_0x427e0a){const _0x3c5983=_0x515441['ormqY'][_0x23b9a9(0x160)]('|');let _0x2aae9d=0x0;while(!![]){switch(_0x3c5983[_0x2aae9d++]){case'0':await _0x32d250[_0x23b9a9(0x25f)]();continue;case'1':console[_0x23b9a9(0x16b)](_0x23b9a9(0x27b),_0x427e0a);continue;case'2':if(_0x515441['mZTdM'](_0x427e0a,DatabaseError))return _0x14a742[_0x23b9a9(0x1d7)](0x1f4)[_0x23b9a9(0x1f2)]({'status':_0x515441[_0x23b9a9(0x130)],'message':_0x515441[_0x23b9a9(0x25d)],'detail':_0x427e0a['message']});continue;case'3':if(_0x515441[_0x23b9a9(0x109)](_0x427e0a,UniqueConstraintError))return _0x14a742[_0x23b9a9(0x1d7)](0x199)[_0x23b9a9(0x1f2)]({'status':_0x23b9a9(0x16b),'message':_0x23b9a9(0x13b),'detail':_0x515441[_0x23b9a9(0x251)]});continue;case'4':return _0x14a742[_0x23b9a9(0x1d7)](0x1f4)[_0x23b9a9(0x1f2)]({'status':_0x515441[_0x23b9a9(0x130)],'message':_0x515441['FnRKd'],'detail':_0x427e0a[_0x23b9a9(0x1ee)]});case'5':if(_0x427e0a[_0x23b9a9(0x1ee)][_0x23b9a9(0x1dd)](_0x515441[_0x23b9a9(0x18b)])||_0x427e0a[_0x23b9a9(0x1ee)]['includes'](_0x515441[_0x23b9a9(0x1c6)])||_0x427e0a['message'][_0x23b9a9(0x1dd)](_0x515441[_0x23b9a9(0x191)])||_0x427e0a['message'][_0x23b9a9(0x1dd)]('no\x20válido'))return _0x14a742['status'](0x190)[_0x23b9a9(0x1f2)]({'status':_0x515441[_0x23b9a9(0x130)],'message':_0x427e0a['message']});continue;case'6':if(_0x427e0a instanceof ValidationError)return _0x14a742['status'](0x190)[_0x23b9a9(0x1f2)]({'status':'error','message':_0x515441[_0x23b9a9(0x248)],'detail':_0x427e0a['errors'][_0x23b9a9(0x25b)](_0x2df102=>_0x2df102[_0x23b9a9(0x1ee)])});continue;}break;}}},exports['marcarVentaCompletada']=async(_0x492bdc,_0x2f008a)=>{const _0xea9bfe=a0_0x2178a1,_0x13ffc1={'npOhg':_0xea9bfe(0x150),'tQVmD':_0xea9bfe(0x16b),'zkbji':_0xea9bfe(0x11e),'vzpEV':_0xea9bfe(0x228),'JturV':_0xea9bfe(0xfe),'nBvGr':_0xea9bfe(0x234),'KTEca':_0xea9bfe(0x18c),'wnVSu':function(_0x3129fd,_0x31c651){return _0x3129fd===_0x31c651;}},_0x17012d=await sequelize['transaction']();try{const {id:_0x324648}=_0x492bdc[_0xea9bfe(0x26d)],_0x5ab4f4=await Ventas['findByPk'](_0x324648,{'include':[{'model':Detalle_Venta,'as':_0x13ffc1[_0xea9bfe(0x1a6)]}],'transaction':_0x17012d});if(!_0x5ab4f4)return await _0x17012d[_0xea9bfe(0x25f)](),_0x2f008a[_0xea9bfe(0x1d7)](0x194)[_0xea9bfe(0x1f2)]({'status':_0x13ffc1[_0xea9bfe(0x23a)],'message':_0x13ffc1[_0xea9bfe(0x101)]});if(_0x5ab4f4[_0xea9bfe(0x266)]!==0x3)return await _0x17012d[_0xea9bfe(0x25f)](),_0x2f008a[_0xea9bfe(0x1d7)](0x190)[_0xea9bfe(0x1f2)]({'status':_0x13ffc1['tQVmD'],'message':_0x13ffc1['vzpEV']});await _0x5ab4f4[_0xea9bfe(0x20d)]({'Estado':0x1,'Fecha_Completado':new Date()},{'transaction':_0x17012d}),await _0x17012d['commit'](),_0x2f008a[_0xea9bfe(0x1f2)]({'status':_0x13ffc1[_0xea9bfe(0xfc)],'message':_0xea9bfe(0x126),'data':{'Id_Ventas':_0x5ab4f4[_0xea9bfe(0x162)],'Estado':_0x5ab4f4[_0xea9bfe(0x266)],'EstadoDescripcion':_0x13ffc1[_0xea9bfe(0x258)],'Fecha_Completado':_0x5ab4f4[_0xea9bfe(0x24c)]}});}catch(_0x2cb6a9){await _0x17012d[_0xea9bfe(0x25f)](),console[_0xea9bfe(0x16b)](_0x13ffc1[_0xea9bfe(0x11c)],_0x2cb6a9),_0x2f008a[_0xea9bfe(0x1d7)](0x1f4)['json']({'status':_0x13ffc1['tQVmD'],'message':_0x13ffc1[_0xea9bfe(0xf8)](process[_0xea9bfe(0x154)][_0xea9bfe(0x1d0)],_0xea9bfe(0x133))?_0xea9bfe(0x12e)+_0x2cb6a9['message']:'Error\x20al\x20marcar\x20venta\x20como\x20completada'});}},exports[a0_0x2178a1(0x250)]=async(_0x365d57,_0x329ae5)=>{const _0x523e02=a0_0x2178a1,_0x3e4a05={'BTSMj':_0x523e02(0x150),'tXLZI':'error','aombL':_0x523e02(0x11e),'jlwTA':function(_0x54e98e,_0x3dfb85){return _0x54e98e!==_0x3dfb85;},'jTZih':_0x523e02(0x236),'zYgIk':'success','lydyY':_0x523e02(0x17f),'GtoKv':_0x523e02(0x23e),'GlGBE':_0x523e02(0x1f4),'fLCXX':function(_0x5cc18b,_0x485ad7){return _0x5cc18b===_0x485ad7;},'SflPJ':_0x523e02(0x133),'ONebv':_0x523e02(0x247)},_0x2baeee=await sequelize['transaction']();try{const {id:_0x35fe23}=_0x365d57[_0x523e02(0x26d)],_0x2d21d8=await Ventas[_0x523e02(0x211)](_0x35fe23,{'include':[{'model':Detalle_Venta,'as':_0x3e4a05['BTSMj']}],'transaction':_0x2baeee});if(!_0x2d21d8)return await _0x2baeee[_0x523e02(0x25f)](),_0x329ae5[_0x523e02(0x1d7)](0x194)[_0x523e02(0x1f2)]({'status':_0x3e4a05[_0x523e02(0x1fb)],'message':_0x3e4a05[_0x523e02(0x28b)]});if(_0x3e4a05[_0x523e02(0x230)](_0x2d21d8['Estado'],0x3))return await _0x2baeee[_0x523e02(0x25f)](),_0x329ae5[_0x523e02(0x1d7)](0x190)[_0x523e02(0x1f2)]({'status':_0x3e4a05[_0x523e02(0x1fb)],'message':_0x3e4a05[_0x523e02(0x242)]});await _0x2d21d8[_0x523e02(0x20d)]({'Estado':0x2,'Fecha_Anulacion':new Date()},{'transaction':_0x2baeee}),await _0x2baeee[_0x523e02(0x260)](),_0x329ae5['json']({'status':_0x3e4a05[_0x523e02(0x225)],'message':_0x3e4a05['lydyY'],'data':{'Id_Ventas':_0x2d21d8[_0x523e02(0x162)],'Estado':_0x2d21d8['Estado'],'EstadoDescripcion':_0x3e4a05[_0x523e02(0x1fc)],'Fecha_Anulacion':_0x2d21d8[_0x523e02(0x15a)]}});}catch(_0x3a7b61){await _0x2baeee[_0x523e02(0x25f)](),console[_0x523e02(0x16b)](_0x3e4a05['GlGBE'],_0x3a7b61),_0x329ae5[_0x523e02(0x1d7)](0x1f4)[_0x523e02(0x1f2)]({'status':_0x3e4a05[_0x523e02(0x1fb)],'message':_0x3e4a05['fLCXX'](process[_0x523e02(0x154)][_0x523e02(0x1d0)],_0x3e4a05[_0x523e02(0x16f)])?_0x523e02(0x188)+_0x3a7b61[_0x523e02(0x1ee)]:_0x3e4a05[_0x523e02(0x1af)]});}},exports[a0_0x2178a1(0x220)]=async(_0x5c7cc5,_0x42d414)=>{const _0x251f5f=a0_0x2178a1,_0x2cdb4f={'arcRy':'error','puhTl':_0x251f5f(0x1a7),'wkaPq':function(_0xece33d,_0x49ba5f){return _0xece33d>_0x49ba5f;},'JHQDb':function(_0x51ca50,_0x1dc3ec){return _0x51ca50(_0x1dc3ec);},'psdti':function(_0x3ed945,_0x514d92){return _0x3ed945<_0x514d92;},'FtzJJ':'success','jZMED':_0x251f5f(0x241),'JBhcE':_0x251f5f(0x19e)};try{const {Id_Productos:_0x3e9280,Cantidad:_0x3bc1,Tallas:_0x45ae23,Tamanos:_0x50a8cd}=_0x5c7cc5[_0x251f5f(0x116)];if(!_0x3e9280)return _0x42d414[_0x251f5f(0x1d7)](0x190)[_0x251f5f(0x1f2)]({'status':_0x2cdb4f[_0x251f5f(0x275)],'message':'ID\x20de\x20producto\x20es\x20requerido'});const _0x3fefd3=await Productos['findByPk'](_0x3e9280);if(!_0x3fefd3)return _0x42d414[_0x251f5f(0x1d7)](0x194)[_0x251f5f(0x1f2)]({'status':_0x251f5f(0x16b),'message':_0x2cdb4f[_0x251f5f(0x28a)]});let _0x45247b=!![],_0x36a149=[];if(_0x45ae23&&_0x2cdb4f[_0x251f5f(0x159)](_0x45ae23[_0x251f5f(0x1d4)],0x0))for(const _0x3c8629 of _0x45ae23){const _0x4a8ac4=_0x3c8629[_0x251f5f(0x1fa)]||_0x3c8629[_0x251f5f(0x23b)]||_0x3c8629[_0x251f5f(0x207)]||'',_0x1468c5=_0x2cdb4f[_0x251f5f(0x263)](Number,_0x3c8629[_0x251f5f(0x146)]||_0x3c8629[_0x251f5f(0x254)]||0x0);if(!_0x4a8ac4){_0x45247b=![],_0x36a149[_0x251f5f(0x287)](_0x251f5f(0x1cd)+_0x3fefd3[_0x251f5f(0x1d2)]);continue;}const _0x47dc88=await _0x45ae23['findOne']({'where':{'Nombre':_0x4a8ac4}});if(!_0x47dc88){_0x45247b=![],_0x36a149['push']('Talla\x20'+_0x4a8ac4+_0x251f5f(0x216));continue;}const _0x5cfe43=await Producto_Tallas[_0x251f5f(0x10b)]({'where':{'Id_Productos':_0x3fefd3[_0x251f5f(0x165)],'Id_Tallas':_0x47dc88[_0x251f5f(0x147)]}});(!_0x5cfe43||_0x2cdb4f['psdti'](_0x5cfe43[_0x251f5f(0x19f)],_0x1468c5))&&(_0x45247b=![],_0x36a149['push'](_0x251f5f(0x1ea)+_0x4a8ac4+_0x251f5f(0x1ec)+(_0x5cfe43?.[_0x251f5f(0x19f)]||0x0)+_0x251f5f(0x174)+_0x1468c5));}if(_0x50a8cd&&_0x2cdb4f[_0x251f5f(0x159)](_0x50a8cd[_0x251f5f(0x1d4)],0x0))for(const _0x302c9d of _0x50a8cd){const _0x390c5f=_0x302c9d[_0x251f5f(0x207)]||_0x302c9d[_0x251f5f(0x1d2)]||'';if(!_0x390c5f){_0x45247b=![],_0x36a149['push']('Nombre\x20de\x20tamaño\x20no\x20válido\x20para\x20el\x20producto\x20'+_0x3fefd3['Nombre']);continue;}const _0x5d209d=await Tamano['findOne']({'where':{'Nombre':_0x390c5f}});if(!_0x5d209d){_0x45247b=![],_0x36a149['push'](_0x251f5f(0x278)+_0x390c5f+'\x20no\x20encontrado');continue;}const _0x2cd2c9=await Producto_Tamano['findOne']({'where':{'Id_Productos':_0x3fefd3[_0x251f5f(0x165)],'Id_Tamano':_0x5d209d['Id_Tamano']}});!_0x2cd2c9&&(_0x45247b=![],_0x36a149[_0x251f5f(0x287)](_0x251f5f(0x139)+_0x3fefd3[_0x251f5f(0x1d2)]+'\x20no\x20tiene\x20el\x20tamaño\x20'+_0x390c5f+_0x251f5f(0x221)));}_0x42d414['json']({'status':_0x2cdb4f[_0x251f5f(0x261)],'data':{'Id_Productos':_0x3fefd3['Id_Productos'],'Nombre':_0x3fefd3[_0x251f5f(0x1d2)],'stockDisponible':_0x45247b,'mensajes':_0x36a149}});}catch(_0x2c5e75){console['error'](_0x2cdb4f['jZMED'],_0x2c5e75),_0x42d414['status'](0x1f4)[_0x251f5f(0x1f2)]({'status':_0x2cdb4f[_0x251f5f(0x275)],'message':_0x2cdb4f[_0x251f5f(0x137)]});}},exports[a0_0x2178a1(0x264)]=async(_0x3eb4f9,_0x431ab0)=>{const _0x57730a=a0_0x2178a1,_0x459d37={'WeGTH':_0x57730a(0x150),'hCqSo':_0x57730a(0x201),'RhONw':'Id_Empleados_Empleado','QCHVl':_0x57730a(0x1f6),'HGGGJ':_0x57730a(0x12d)};try{const {fecha:_0x326fb4}=_0x3eb4f9[_0x57730a(0x10a)],_0x253707=_0x326fb4?new Date(_0x326fb4):new Date(),_0x562230=await Ventas[_0x57730a(0x205)]({'where':{'Fecha':{[sequelize['Op']['between']]:[new Date(_0x253707[_0x57730a(0x233)](0x0,0x0,0x0,0x0)),new Date(_0x253707[_0x57730a(0x233)](0x17,0x3b,0x3b,0x3e7))]},'Estado':0x1},'include':[{'model':Detalle_Venta,'as':_0x459d37[_0x57730a(0x229)],'include':[{'model':Productos,'as':_0x459d37[_0x57730a(0x111)]}]},{'model':Empleados,'as':_0x459d37[_0x57730a(0x22f)],'attributes':['Nombre']}]}),_0x1493c4=_0x562230['reduce']((_0xc53e4c,_0xef60ad)=>_0xc53e4c+Number(_0xef60ad[_0x57730a(0x145)]),0x0),_0x36f3de=_0x562230[_0x57730a(0x1d4)],_0x3dd062={};_0x562230[_0x57730a(0x255)](_0x47e422=>{const _0x34f7a6=_0x57730a,_0x18c0e9={'fSvmD':function(_0x33a9c9,_0x3daba8){return _0x33a9c9(_0x3daba8);}};_0x47e422[_0x34f7a6(0x150)][_0x34f7a6(0x255)](_0x2a5581=>{const _0x49cc85=_0x34f7a6,_0x123a35=_0x2a5581['Id_Productos'],_0x34f08e=_0x2a5581[_0x49cc85(0x201)]?.[_0x49cc85(0x1d2)]||_0x49cc85(0x288);!_0x3dd062[_0x123a35]&&(_0x3dd062[_0x123a35]={'Id_Productos':_0x123a35,'Nombre':_0x34f08e,'Cantidad':0x0,'Total':0x0}),_0x3dd062[_0x123a35][_0x49cc85(0x254)]+=_0x2a5581['Cantidad'],_0x3dd062[_0x123a35][_0x49cc85(0x145)]+=_0x18c0e9[_0x49cc85(0xff)](Number,_0x2a5581[_0x49cc85(0x1b1)]);});});const _0x2292d1=Object['values'](_0x3dd062)[_0x57730a(0x195)]((_0x19ed8e,_0xd967ae)=>_0xd967ae[_0x57730a(0x145)]-_0x19ed8e[_0x57730a(0x145)])[_0x57730a(0x279)](0x0,0x5);_0x431ab0['json']({'status':'success','data':{'fecha':_0x253707['toISOString']()[_0x57730a(0x160)]('T')[0x0],'totalVentas':_0x1493c4,'cantidadVentas':_0x36f3de,'productosTop':_0x2292d1,'ventas':_0x562230[_0x57730a(0x25b)](_0x27b28c=>({'Id_Ventas':_0x27b28c['Id_Ventas'],'Total':_0x27b28c[_0x57730a(0x145)],'Empleado':_0x27b28c[_0x57730a(0x1b6)]?.[_0x57730a(0x1d2)],'Fecha':_0x27b28c[_0x57730a(0x11d)]}))}});}catch(_0x2532b5){console[_0x57730a(0x16b)](_0x459d37[_0x57730a(0x176)],_0x2532b5),_0x431ab0[_0x57730a(0x1d7)](0x1f4)[_0x57730a(0x1f2)]({'status':'error','message':_0x459d37[_0x57730a(0x142)]});}},exports['reporteVentasMensuales']=async(_0x1532be,_0x145e52)=>{const _0x39ea6a=a0_0x2178a1,_0x513ef1={'crNVl':function(_0x42e295,_0x127c34){return _0x42e295(_0x127c34);},'zIHfK':'Desconocido','vDpNQ':function(_0xb30c57,_0x54611e){return _0xb30c57(_0x54611e);},'LLdxj':function(_0xb38bba,_0x5a8bc8){return _0xb38bba-_0x5a8bc8;},'jquQO':function(_0xd8ade8,_0x48898c){return _0xd8ade8(_0x48898c);},'bgXEI':function(_0x5acfb6,_0x2add54){return _0x5acfb6+_0x2add54;},'hMhZj':'Detalle_Venta','htkOC':_0x39ea6a(0x1b6),'ePzJV':_0x39ea6a(0x1d2),'ySTtG':'success','IbkRr':function(_0x5d23df,_0x55219a){return _0x5d23df+_0x55219a;},'rDjXC':function(_0x585632,_0x34edb8){return _0x585632/_0x34edb8;},'IOopA':function(_0x225498,_0x40b907){return _0x225498+_0x40b907;},'kqRZa':_0x39ea6a(0x265),'JBiln':_0x39ea6a(0x16b),'FkAyN':'Error\x20al\x20generar\x20reporte\x20mensual'};try{const {mes:_0x1b2261,año:_0x19bf19}=_0x1532be['query'],_0x3ea85c=new Date(),_0x2fabf7=_0x1b2261?_0x513ef1[_0x39ea6a(0x15e)](_0x513ef1['jquQO'](parseInt,_0x1b2261),0x1):_0x3ea85c['getMonth'](),_0x8194bc=_0x19bf19?parseInt(_0x19bf19):_0x3ea85c[_0x39ea6a(0x10d)](),_0x23f878=new Date(_0x8194bc,_0x2fabf7,0x1),_0x1ab7a4=new Date(_0x8194bc,_0x513ef1[_0x39ea6a(0x243)](_0x2fabf7,0x1),0x0,0x17,0x3b,0x3b,0x3e7),_0x460235=await Ventas[_0x39ea6a(0x205)]({'where':{'Fecha':{[sequelize['Op'][_0x39ea6a(0x1e7)]]:[_0x23f878,_0x1ab7a4]},'Estado':0x1},'include':[{'model':Detalle_Venta,'as':_0x513ef1[_0x39ea6a(0x198)],'include':[{'model':Productos,'as':'Id_Productos_Producto'}]},{'model':Empleados,'as':_0x513ef1['htkOC'],'attributes':[_0x513ef1['ePzJV']]}]}),_0x55014d=_0x460235['reduce']((_0x33fd6a,_0x2e7840)=>_0x33fd6a+Number(_0x2e7840[_0x39ea6a(0x145)]),0x0),_0x277f1e=_0x460235['length'],_0x339d29={};_0x460235[_0x39ea6a(0x255)](_0x391cb3=>{const _0x42f500=_0x39ea6a,_0x4ddab7=_0x391cb3[_0x42f500(0x11d)][_0x42f500(0x173)]()[_0x42f500(0x160)]('T')[0x0];!_0x339d29[_0x4ddab7]&&(_0x339d29[_0x4ddab7]={'total':0x0,'cantidad':0x0}),_0x339d29[_0x4ddab7][_0x42f500(0x26e)]+=_0x513ef1['crNVl'](Number,_0x391cb3[_0x42f500(0x145)]),_0x339d29[_0x4ddab7][_0x42f500(0x146)]+=0x1;});const _0x49de7d={};_0x460235['forEach'](_0x4067e6=>{const _0x13b940=_0x39ea6a,_0xa0070a=_0x4067e6['Id_Empleados'],_0x443517=_0x4067e6['Id_Empleados_Empleado']?.['Nombre']||_0x513ef1[_0x13b940(0x18d)];!_0x49de7d[_0xa0070a]&&(_0x49de7d[_0xa0070a]={'Id_Empleados':_0xa0070a,'Nombre':_0x443517,'Total':0x0,'Cantidad':0x0}),_0x49de7d[_0xa0070a][_0x13b940(0x145)]+=_0x513ef1[_0x13b940(0x16a)](Number,_0x4067e6['Total']),_0x49de7d[_0xa0070a]['Cantidad']+=0x1;});const _0x2488e2=Object['values'](_0x49de7d)['sort']((_0x5c2384,_0x326692)=>_0x326692[_0x39ea6a(0x145)]-_0x5c2384[_0x39ea6a(0x145)])[_0x39ea6a(0x279)](0x0,0x5);_0x145e52[_0x39ea6a(0x1f2)]({'status':_0x513ef1[_0x39ea6a(0x1d1)],'data':{'mes':_0x513ef1['IbkRr'](_0x2fabf7,0x1),'año':_0x8194bc,'totalVentas':_0x55014d,'cantidadVentas':_0x277f1e,'promedioDiario':_0x513ef1[_0x39ea6a(0x1aa)](_0x277f1e,new Date(_0x8194bc,_0x513ef1['IOopA'](_0x2fabf7,0x1),0x0)[_0x39ea6a(0x232)]()),'ventasPorDia':_0x339d29,'empleadosTop':_0x2488e2}});}catch(_0x24dd94){console[_0x39ea6a(0x16b)](_0x513ef1['kqRZa'],_0x24dd94),_0x145e52[_0x39ea6a(0x1d7)](0x1f4)[_0x39ea6a(0x1f2)]({'status':_0x513ef1[_0x39ea6a(0x186)],'message':_0x513ef1[_0x39ea6a(0x1a0)]});}},exports['validarStockVenta']=async(_0x1a60b6,_0x286ae8)=>{const _0x4ad062=a0_0x2178a1,_0x1fbfb3={'bjdgF':function(_0x556798,_0x478ea1){return _0x556798===_0x478ea1;},'rnsPM':_0x4ad062(0x16b),'bwuFD':'Producto\x20no\x20encontrado','oxdpe':function(_0x7f810,_0x42a09b){return _0x7f810>_0x42a09b;},'hfzuK':function(_0x7f1c3a,_0x2f297d){return _0x7f1c3a(_0x2f297d);},'SDTka':_0x4ad062(0x1fa),'LFsaz':'N/A','bFDar':_0x4ad062(0x1f8),'Czqsu':function(_0x2e3653,_0x24c29a){return _0x2e3653>=_0x24c29a;},'ghQAy':function(_0x23b60e,_0x5b5844){return _0x23b60e(_0x5b5844);},'DkqmG':function(_0x212ec6,_0x399205){return _0x212ec6>=_0x399205;},'hTxxy':_0x4ad062(0x18a),'ZKMNx':function(_0x3fa9ea,_0x5c75de){return _0x3fa9ea>_0x5c75de;},'XdWrc':_0x4ad062(0x1c5),'UCPKg':_0x4ad062(0x17a),'ysjOi':'Tamaño\x20no\x20encontrado','ObcXN':_0x4ad062(0x1d9),'jhLpA':function(_0xa2321e,_0x20a869){return _0xa2321e*_0x20a869;},'ugNdS':_0x4ad062(0xf9),'aPgEK':function(_0xe67fd7,_0x573220){return _0xe67fd7*_0x573220;},'bwMur':'general','aJkDC':function(_0x3c66d2,_0x271421){return _0x3c66d2===_0x271421;},'iSSwM':function(_0x5ceae8,_0x3160aa){return _0x5ceae8===_0x3160aa;},'OFuKB':_0x4ad062(0x177),'BBelF':_0x4ad062(0x147),'vtYHs':function(_0x594539,_0x392d1c){return _0x594539>_0x392d1c;},'xrLhr':_0x4ad062(0x24e),'lhzlD':function(_0x19777f,_0x316416){return _0x19777f(_0x316416);},'OhNzj':function(_0x3a8001,_0x2d90f9){return _0x3a8001||_0x2d90f9;},'rjojV':_0x4ad062(0x199),'IgGoc':'success','ejYSU':'Error\x20al\x20validar\x20stock\x20de\x20venta:','KvbyB':_0x4ad062(0x1a5)};try{const {Detalle_Venta:_0x57c250}=_0x1a60b6['body'];if(!_0x57c250||!Array[_0x4ad062(0x204)](_0x57c250)||_0x1fbfb3[_0x4ad062(0x170)](_0x57c250['length'],0x0))return _0x286ae8['status'](0x190)['json']({'status':_0x1fbfb3[_0x4ad062(0x289)],'message':_0x4ad062(0x12b)});const _0x5a352c=[];let _0x5c9cbc=!![];const _0x223181=[];for(const _0x2ce0d0 of _0x57c250){const {Id_Productos:_0xddac37,Cantidad:_0x27d6f6,Tallas:_0x422704,Tamanos:_0x20e1ac}=_0x2ce0d0;if(!_0xddac37){_0x5c9cbc=![],_0x223181['push'](_0x4ad062(0x180));continue;}const _0x2ed64c=await Productos[_0x4ad062(0x211)](_0xddac37);if(!_0x2ed64c){_0x5c9cbc=![],_0x223181['push'](_0x4ad062(0x21f)+_0xddac37+_0x4ad062(0x1b8)),_0x5a352c[_0x4ad062(0x287)]({'Id_Productos':_0xddac37,'Nombre':_0x1fbfb3[_0x4ad062(0x138)],'stockDisponible':![],'mensajes':[_0x4ad062(0x21f)+_0xddac37+_0x4ad062(0x1b8)]});continue;}let _0x1e565a=!![],_0x23ffbf=[],_0x315b2c=[];if(_0x422704&&_0x1fbfb3[_0x4ad062(0x280)](_0x422704[_0x4ad062(0x1d4)],0x0)){let _0x4d9303=0x0;for(const _0x430ecb of _0x422704){const _0x3a8603=_0x430ecb[_0x4ad062(0x1fa)]||_0x430ecb['Talla']||_0x430ecb['nombre']||'',_0x4effdb=_0x1fbfb3[_0x4ad062(0x155)](Number,_0x430ecb[_0x4ad062(0x146)]||_0x430ecb[_0x4ad062(0x254)]||0x0);if(!_0x3a8603){_0x1e565a=![],_0x5c9cbc=![],_0x23ffbf[_0x4ad062(0x287)](_0x4ad062(0x1cd)+_0x2ed64c['Nombre']),_0x315b2c[_0x4ad062(0x287)]({'tipo':_0x1fbfb3[_0x4ad062(0x187)],'nombre':_0x1fbfb3[_0x4ad062(0x1f7)],'disponible':0x0,'solicitado':0x0,'suficiente':![],'error':_0x1fbfb3[_0x4ad062(0x102)]});continue;}const _0x2a732a=await _0x422704['findOne']({'where':{'Nombre':_0x3a8603}});if(!_0x2a732a){_0x1e565a=![],_0x5c9cbc=![],_0x23ffbf[_0x4ad062(0x287)]('Talla\x20'+_0x3a8603+_0x4ad062(0x216)),_0x315b2c['push']({'tipo':_0x1fbfb3[_0x4ad062(0x187)],'nombre':_0x3a8603,'disponible':0x0,'solicitado':_0x4effdb,'suficiente':![],'error':_0x4ad062(0x21d)});continue;}const _0x50a354=await Producto_Tallas[_0x4ad062(0x10b)]({'where':{'Id_Productos':_0x2ed64c[_0x4ad062(0x165)],'Id_Tallas':_0x2a732a['Id_Tallas']}}),_0x3f49f2=_0x1fbfb3[_0x4ad062(0x155)](Number,_0x50a354?.[_0x4ad062(0x19f)]||0x0),_0x5e3aa7=_0x1fbfb3[_0x4ad062(0x235)](_0x3f49f2,_0x4effdb);!_0x5e3aa7&&(_0x1e565a=![],_0x5c9cbc=![],_0x23ffbf[_0x4ad062(0x287)](_0x4ad062(0x1ea)+_0x3a8603+_0x4ad062(0x1ec)+_0x3f49f2+_0x4ad062(0x174)+_0x4effdb)),_0x315b2c['push']({'tipo':_0x1fbfb3[_0x4ad062(0x187)],'nombre':_0x3a8603,'disponible':_0x3f49f2,'solicitado':_0x4effdb,'suficiente':_0x5e3aa7}),_0x4d9303+=_0x4effdb;}const _0x429d76=_0x1fbfb3[_0x4ad062(0x20a)](Number,_0x2ed64c[_0x4ad062(0x19f)]||0x0),_0x3d53e6=_0x1fbfb3[_0x4ad062(0x14f)](_0x429d76,_0x4d9303);!_0x3d53e6&&(_0x1e565a=![],_0x5c9cbc=![],_0x23ffbf[_0x4ad062(0x287)](_0x4ad062(0x13c)+_0x2ed64c[_0x4ad062(0x1d2)]+':\x20disponible\x20'+_0x429d76+_0x4ad062(0x174)+_0x4d9303)),_0x315b2c[_0x4ad062(0x287)]({'tipo':_0x1fbfb3[_0x4ad062(0x202)],'nombre':_0x2ed64c['Nombre'],'disponible':_0x429d76,'solicitado':_0x4d9303,'suficiente':_0x3d53e6});}if(_0x20e1ac&&_0x1fbfb3[_0x4ad062(0x1b3)](_0x20e1ac[_0x4ad062(0x1d4)],0x0))for(const _0xd9e9e1 of _0x20e1ac){const _0x32ee5e=_0xd9e9e1[_0x4ad062(0x207)]||_0xd9e9e1[_0x4ad062(0x1d2)]||'';if(!_0x32ee5e){_0x1e565a=![],_0x5c9cbc=![],_0x23ffbf['push'](_0x4ad062(0x25c)+_0x2ed64c[_0x4ad062(0x1d2)]),_0x315b2c[_0x4ad062(0x287)]({'tipo':_0x1fbfb3[_0x4ad062(0x149)],'nombre':_0x1fbfb3['LFsaz'],'disponible':0x0,'solicitado':0x0,'suficiente':![],'error':_0x1fbfb3['UCPKg']});continue;}const _0x5babc3=await Tamano['findOne']({'where':{'Nombre':_0x32ee5e}});if(!_0x5babc3){_0x1e565a=![],_0x5c9cbc=![],_0x23ffbf[_0x4ad062(0x287)](_0x4ad062(0x278)+_0x32ee5e+_0x4ad062(0x1b8)),_0x315b2c[_0x4ad062(0x287)]({'tipo':_0x1fbfb3[_0x4ad062(0x149)],'nombre':_0x32ee5e,'disponible':0x0,'solicitado':0x0,'suficiente':![],'error':_0x1fbfb3['ysjOi']});continue;}const _0x1b60cc=await Producto_Tamano['findOne']({'where':{'Id_Productos':_0x2ed64c[_0x4ad062(0x165)],'Id_Tamano':_0x5babc3[_0x4ad062(0x112)]}});if(!_0x1b60cc){_0x1e565a=![],_0x5c9cbc=![],_0x23ffbf[_0x4ad062(0x287)](_0x4ad062(0x139)+_0x2ed64c[_0x4ad062(0x1d2)]+'\x20no\x20tiene\x20el\x20tamaño\x20'+_0x32ee5e+_0x4ad062(0x221)),_0x315b2c[_0x4ad062(0x287)]({'tipo':_0x1fbfb3[_0x4ad062(0x149)],'nombre':_0x32ee5e,'disponible':0x0,'solicitado':0x0,'suficiente':![],'error':_0x1fbfb3['ObcXN']});continue;}const _0x4db7ac=await Producto_Tamano_Insumos[_0x4ad062(0x205)]({'where':{'Id_Producto_Tamano':_0x1b60cc[_0x4ad062(0x132)]},'include':[{'model':Insumos,'as':_0x4ad062(0x1a1)}]}),_0x5c70e8=await Tamano_Insumos['findAll']({'where':{'Id_Tamano':_0x5babc3[_0x4ad062(0x112)]},'include':[{'model':Insumos,'as':_0x4ad062(0x1a1)}]}),_0x504f58=_0x1fbfb3['ghQAy'](Number,_0xd9e9e1[_0x4ad062(0x254)]||_0xd9e9e1[_0x4ad062(0x146)]||0x0);let _0x8542a6=!![];const _0x4b5840=[],_0x17eb0d=new Map();for(const _0xc0da54 of _0x4db7ac){const _0x1cb2c0=_0xc0da54[_0x4ad062(0x1a1)],_0x4f2c9f=_0x1fbfb3[_0x4ad062(0x155)](Number,_0xc0da54[_0x4ad062(0x26a)]||0x0),_0xb3bb05=_0x1fbfb3[_0x4ad062(0x1e0)](_0x4f2c9f,_0x504f58),_0x2cbdbb=_0x1fbfb3[_0x4ad062(0x20a)](Number,_0x1cb2c0[_0x4ad062(0x19f)]||0x0),_0x119387=_0x2cbdbb>=_0xb3bb05;!_0x119387&&(_0x8542a6=![],_0x1e565a=![],_0x5c9cbc=![],_0x23ffbf[_0x4ad062(0x287)](_0x4ad062(0x1e9)+_0x1cb2c0[_0x4ad062(0x1d2)]+_0x4ad062(0x1db)+_0x2cbdbb+_0x4ad062(0x143)+_0xb3bb05)),_0x4b5840[_0x4ad062(0x287)]({'insumo':_0x1cb2c0[_0x4ad062(0x1d2)],'disponible':_0x2cbdbb,'necesario':_0xb3bb05,'suficiente':_0x119387,'tipo':_0x1fbfb3[_0x4ad062(0x16c)]}),_0x17eb0d[_0x4ad062(0x253)](_0x1cb2c0['Id_Insumos'],!![]);}for(const _0x404f34 of _0x5c70e8){const _0x49d372=_0x404f34[_0x4ad062(0x1a1)];if(_0x17eb0d[_0x4ad062(0x115)](_0x49d372[_0x4ad062(0x14a)]))continue;const _0x38ae5f=Number(_0x404f34[_0x4ad062(0x254)]||0x0),_0xfcae95=_0x1fbfb3[_0x4ad062(0x1d3)](_0x38ae5f,_0x504f58),_0x6f0961=_0x1fbfb3[_0x4ad062(0x155)](Number,_0x49d372[_0x4ad062(0x19f)]||0x0),_0x51eecf=_0x1fbfb3[_0x4ad062(0x235)](_0x6f0961,_0xfcae95);!_0x51eecf&&(_0x8542a6=![],_0x1e565a=![],_0x5c9cbc=![],_0x23ffbf[_0x4ad062(0x287)](_0x4ad062(0x24f)+_0x49d372['Nombre']+_0x4ad062(0x1db)+_0x6f0961+_0x4ad062(0x143)+_0xfcae95)),_0x4b5840[_0x4ad062(0x287)]({'insumo':_0x49d372[_0x4ad062(0x1d2)],'disponible':_0x6f0961,'necesario':_0xfcae95,'suficiente':_0x51eecf,'tipo':_0x1fbfb3['bwMur']});}_0x315b2c[_0x4ad062(0x287)]({'tipo':_0x1fbfb3['XdWrc'],'nombre':_0x32ee5e,'cantidad':_0x504f58,'insumos':_0x4b5840,'suficiente':_0x8542a6});}if((!_0x422704||_0x1fbfb3[_0x4ad062(0x1c3)](_0x422704[_0x4ad062(0x1d4)],0x0))&&(!_0x20e1ac||_0x1fbfb3[_0x4ad062(0x1ad)](_0x20e1ac[_0x4ad062(0x1d4)],0x0))){const _0x130c38=await Producto_Tallas[_0x4ad062(0x205)]({'where':{'Id_Productos':_0x2ed64c[_0x4ad062(0x165)]},'include':[{'model':_0x422704,'as':_0x1fbfb3[_0x4ad062(0x269)],'attributes':[_0x1fbfb3[_0x4ad062(0x246)],_0x4ad062(0x1d2)]}]});if(_0x130c38&&_0x1fbfb3['vtYHs'](_0x130c38['length'],0x0))_0x1e565a=![],_0x5c9cbc=![],_0x23ffbf[_0x4ad062(0x287)]('El\x20producto\x20'+_0x2ed64c[_0x4ad062(0x1d2)]+_0x4ad062(0x1e3)+_0x130c38['map'](_0x42efbd=>_0x42efbd[_0x4ad062(0x177)]?.[_0x4ad062(0x1d2)]||'N/A')['join'](',\x20')),_0x315b2c[_0x4ad062(0x287)]({'tipo':_0x1fbfb3['rnsPM'],'nombre':_0x2ed64c[_0x4ad062(0x1d2)],'disponible':0x0,'solicitado':0x0,'suficiente':![],'error':_0x1fbfb3[_0x4ad062(0x20e)]});else{const _0x42bb7a=_0x1fbfb3[_0x4ad062(0x27a)](Number,_0x2ed64c[_0x4ad062(0x19f)]||0x0),_0x2d3109=Number(_0x1fbfb3[_0x4ad062(0x1fe)](_0x27d6f6,0x0)),_0x4028c8=_0x42bb7a>=_0x2d3109;!_0x4028c8&&(_0x1e565a=![],_0x5c9cbc=![],_0x23ffbf[_0x4ad062(0x287)](_0x4ad062(0x172)+_0x2ed64c[_0x4ad062(0x1d2)]+_0x4ad062(0x1db)+_0x42bb7a+_0x4ad062(0x106)+_0x2d3109)),_0x315b2c[_0x4ad062(0x287)]({'tipo':_0x1fbfb3[_0x4ad062(0x271)],'nombre':_0x2ed64c[_0x4ad062(0x1d2)],'disponible':_0x42bb7a,'solicitado':_0x2d3109,'suficiente':_0x4028c8});}}_0x5a352c[_0x4ad062(0x287)]({'Id_Productos':_0x2ed64c[_0x4ad062(0x165)],'Nombre':_0x2ed64c['Nombre'],'stockDisponible':_0x1e565a,'mensajes':_0x23ffbf,'detallesStock':_0x315b2c});}_0x286ae8[_0x4ad062(0x1f2)]({'status':_0x1fbfb3[_0x4ad062(0x1c4)],'data':{'ventaValida':_0x5c9cbc,'mensajesGenerales':_0x223181,'resultados':_0x5a352c}});}catch(_0x4949c4){console[_0x4ad062(0x16b)](_0x1fbfb3['ejYSU'],_0x4949c4),_0x286ae8[_0x4ad062(0x1d7)](0x1f4)[_0x4ad062(0x1f2)]({'status':_0x1fbfb3[_0x4ad062(0x289)],'message':_0x1fbfb3[_0x4ad062(0x257)]});}},exports['obtenerTallasProducto']=async(_0x122a14,_0x1e2869)=>{const _0x22e7e3=a0_0x2178a1,_0x1c3adc={'DhmwJ':_0x22e7e3(0x16b),'cUWRG':_0x22e7e3(0x113),'FcsnT':_0x22e7e3(0x1a7),'dBjrn':'Id_Tallas_Talla','eolxN':'success','ohaUj':'Error\x20al\x20obtener\x20tallas\x20del\x20producto:','UTBBn':_0x22e7e3(0x104)};try{const {Id_Productos:_0x4bf605}=_0x122a14[_0x22e7e3(0x26d)];if(!_0x4bf605)return _0x1e2869[_0x22e7e3(0x1d7)](0x190)[_0x22e7e3(0x1f2)]({'status':_0x1c3adc[_0x22e7e3(0x1c2)],'message':_0x1c3adc[_0x22e7e3(0x179)]});const _0x4d99b4=await Productos[_0x22e7e3(0x211)](_0x4bf605);if(!_0x4d99b4)return _0x1e2869['status'](0x194)[_0x22e7e3(0x1f2)]({'status':_0x22e7e3(0x16b),'message':_0x1c3adc[_0x22e7e3(0x127)]});const _0x2fe741=await Producto_Tallas[_0x22e7e3(0x205)]({'where':{'Id_Productos':_0x4bf605},'include':[{'model':Tallas,'as':_0x1c3adc[_0x22e7e3(0x1d8)],'attributes':[_0x22e7e3(0x147),'Nombre']}]}),_0x2c033c=_0x2fe741[_0x22e7e3(0x25b)](_0x35c9af=>({'Id_Producto_Tallas':_0x35c9af[_0x22e7e3(0x1a2)],'Id_Tallas':_0x35c9af[_0x22e7e3(0x147)],'Nombre_Talla':_0x35c9af[_0x22e7e3(0x177)]?.[_0x22e7e3(0x1d2)]||_0x22e7e3(0x15f),'Stock':_0x35c9af[_0x22e7e3(0x19f)],'Precio':_0x35c9af[_0x22e7e3(0x267)]||0x0}));_0x1e2869['json']({'status':_0x1c3adc[_0x22e7e3(0x28c)],'data':{'Id_Productos':_0x4d99b4[_0x22e7e3(0x165)],'Nombre':_0x4d99b4[_0x22e7e3(0x1d2)],'tieneTallas':_0x2c033c[_0x22e7e3(0x1d4)]>0x0,'tallasDisponibles':_0x2c033c,'totalTallas':_0x2c033c['length']}});}catch(_0x29f457){console['error'](_0x1c3adc['ohaUj'],_0x29f457),_0x1e2869['status'](0x1f4)['json']({'status':_0x1c3adc[_0x22e7e3(0x1c2)],'message':_0x1c3adc['UTBBn']});}},exports[a0_0x2178a1(0x20b)]=async(_0x420eb9,_0x31b4bb)=>{const _0x15d7e7=a0_0x2178a1,_0x2451ed={'qhjTQ':_0x15d7e7(0x16b),'yTJIz':_0x15d7e7(0x113),'ZvSia':'Id_Tamano','PWGoz':_0x15d7e7(0x136),'JdkRa':_0x15d7e7(0x14a),'pJrlR':_0x15d7e7(0x1d2),'VWDSk':'Stock','PdMBG':function(_0x12f75c,_0x59374e){return _0x12f75c>_0x59374e;},'ENOCe':_0x15d7e7(0x134),'xPdQI':_0x15d7e7(0x1ed)};try{const {Id_Productos:_0x4f861f}=_0x420eb9[_0x15d7e7(0x26d)];if(!_0x4f861f)return _0x31b4bb[_0x15d7e7(0x1d7)](0x190)['json']({'status':_0x2451ed[_0x15d7e7(0x1b7)],'message':_0x2451ed['yTJIz']});const _0x80f8b9=await Productos[_0x15d7e7(0x211)](_0x4f861f);if(!_0x80f8b9)return _0x31b4bb[_0x15d7e7(0x1d7)](0x194)['json']({'status':'error','message':_0x15d7e7(0x1a7)});const _0x369ba8=await Producto_Tamano[_0x15d7e7(0x205)]({'where':{'Id_Productos':_0x4f861f},'include':[{'model':Tamano,'as':'Id_Tamano_Tamano','attributes':[_0x2451ed['ZvSia'],_0x15d7e7(0x1d2),_0x2451ed[_0x15d7e7(0x19c)],_0x15d7e7(0x1ab)]},{'model':Producto_Tamano_Insumos,'as':_0x15d7e7(0x161),'include':[{'model':Insumos,'as':_0x15d7e7(0x1a1),'attributes':[_0x2451ed['JdkRa'],_0x2451ed[_0x15d7e7(0x156)],_0x2451ed[_0x15d7e7(0x140)],'Unidad_Medida']}]}]}),_0x2e2dec=_0x369ba8[_0x15d7e7(0x25b)](_0x160126=>({'Id_Producto_Tamano':_0x160126['Id_Producto_Tamano'],'Id_Tamano':_0x160126[_0x15d7e7(0x112)],'nombre':_0x160126['Id_Tamano_Tamano']?.[_0x15d7e7(0x1d2)]||_0x15d7e7(0x15f),'precio':_0x160126[_0x15d7e7(0x171)]?.[_0x15d7e7(0x1ab)]?.[_0x15d7e7(0x189)]()||'0','Cantidad_Maxima':_0x160126[_0x15d7e7(0x171)]?.[_0x15d7e7(0x136)]||0x0,'insumos':_0x160126[_0x15d7e7(0x161)]?.[_0x15d7e7(0x25b)](_0x4aa1c6=>({'Id_Insumo':_0x4aa1c6['Id_Insumos_Insumo']?.[_0x15d7e7(0x14a)],'Nombre':_0x4aa1c6[_0x15d7e7(0x1a1)]?.[_0x15d7e7(0x1d2)]||_0x15d7e7(0x15f),'Stock':_0x4aa1c6[_0x15d7e7(0x1a1)]?.['Stock']||0x0,'Cantidad_Consumo':_0x4aa1c6[_0x15d7e7(0x26a)]||0x0,'Unidad_Medida':_0x4aa1c6['Id_Insumos_Insumo']?.['Unidad_Medida']||_0x15d7e7(0x15f)}))||[]}));_0x31b4bb[_0x15d7e7(0x1f2)]({'status':_0x15d7e7(0xfe),'data':{'Id_Productos':_0x80f8b9[_0x15d7e7(0x165)],'Nombre':_0x80f8b9[_0x15d7e7(0x1d2)],'tieneTamanos':_0x2451ed[_0x15d7e7(0x214)](_0x2e2dec[_0x15d7e7(0x1d4)],0x0),'tamanosDisponibles':_0x2e2dec,'totalTamanos':_0x2e2dec[_0x15d7e7(0x1d4)]}});}catch(_0xf39914){console[_0x15d7e7(0x16b)](_0x2451ed[_0x15d7e7(0x168)],_0xf39914),_0x31b4bb[_0x15d7e7(0x1d7)](0x1f4)['json']({'status':_0x2451ed[_0x15d7e7(0x1b7)],'message':_0x2451ed[_0x15d7e7(0x262)]});}},exports[a0_0x2178a1(0x135)]=async(_0x1c34b6,_0x5b5d9b)=>{const _0x304dc6=a0_0x2178a1,_0x3c06f8={'PuTlg':_0x304dc6(0x16b),'OcOar':_0x304dc6(0x21c),'LnZQZ':_0x304dc6(0x1b9),'swjZP':_0x304dc6(0x14a),'HQMKX':_0x304dc6(0x1d2),'urCvo':_0x304dc6(0x19f),'LIaIm':_0x304dc6(0x1ef),'JTGEG':_0x304dc6(0xfe),'rZjVF':_0x304dc6(0x227)};try{const {nombreTamano:_0x5be122}=_0x1c34b6[_0x304dc6(0x26d)];if(!_0x5be122)return _0x5b5d9b[_0x304dc6(0x1d7)](0x190)[_0x304dc6(0x1f2)]({'status':_0x3c06f8[_0x304dc6(0x25e)],'message':_0x3c06f8[_0x304dc6(0x1a3)]});const _0x2bb336=await Tamano[_0x304dc6(0x10b)]({'where':{'Nombre':_0x5be122},'include':[{'model':Tamano_Insumos,'as':_0x3c06f8['LnZQZ'],'include':[{'model':Insumos,'as':_0x304dc6(0x1a1),'attributes':[_0x3c06f8[_0x304dc6(0x209)],_0x3c06f8[_0x304dc6(0x157)],_0x3c06f8[_0x304dc6(0x237)],_0x3c06f8[_0x304dc6(0x175)]]}]}]});if(!_0x2bb336)return _0x5b5d9b['status'](0x194)[_0x304dc6(0x1f2)]({'status':_0x3c06f8[_0x304dc6(0x25e)],'message':_0x304dc6(0x278)+_0x5be122+_0x304dc6(0x1b8)});const _0x53a654={'Id_Tamano':_0x2bb336[_0x304dc6(0x112)],'nombre':_0x2bb336['Nombre'],'precio':_0x2bb336[_0x304dc6(0x1ab)]?.[_0x304dc6(0x189)]()||'0','Cantidad_Maxima':_0x2bb336[_0x304dc6(0x136)],'Estado':_0x2bb336[_0x304dc6(0x266)],'insumos':_0x2bb336[_0x304dc6(0x1b9)]?.[_0x304dc6(0x25b)](_0x586db2=>({'Id_Insumo':_0x586db2[_0x304dc6(0x1a1)]?.[_0x304dc6(0x14a)],'Nombre':_0x586db2[_0x304dc6(0x1a1)]?.['Nombre']||'N/A','Stock':_0x586db2[_0x304dc6(0x1a1)]?.[_0x304dc6(0x19f)]||0x0,'Cantidad':_0x586db2[_0x304dc6(0x254)]||0x0,'Unidad_Medida':_0x586db2['Id_Insumos_Insumo']?.[_0x304dc6(0x1ef)]||_0x304dc6(0x15f)}))||[]};_0x5b5d9b[_0x304dc6(0x1f2)]({'status':_0x3c06f8[_0x304dc6(0x18e)],'data':_0x53a654});}catch(_0x45e553){console[_0x304dc6(0x16b)](_0x3c06f8[_0x304dc6(0x153)],_0x45e553),_0x5b5d9b['status'](0x1f4)[_0x304dc6(0x1f2)]({'status':_0x3c06f8[_0x304dc6(0x25e)],'message':_0x304dc6(0x22e)});}},exports[a0_0x2178a1(0x1bb)]=async(_0x58d32f,_0x3a766e)=>{const _0x1dce7d=a0_0x2178a1,_0x42415b={'pCyDl':'Sin\x20Categoría','esSGk':_0x1dce7d(0x15f),'GVKKD':_0x1dce7d(0x113),'PGpPt':_0x1dce7d(0x1a7),'GYtZs':_0x1dce7d(0x171),'oRPBt':_0x1dce7d(0x1d2),'xWBpy':_0x1dce7d(0x136),'GYvUr':_0x1dce7d(0x1ab),'csxru':_0x1dce7d(0x1a1),'VBqNB':_0x1dce7d(0x14a),'cSuzT':_0x1dce7d(0x19f),'UrquS':_0x1dce7d(0x128),'eMzSO':'success','sRlgg':function(_0x41586d,_0x3c5087){return _0x41586d>_0x3c5087;},'SnAAH':_0x1dce7d(0x18f),'pkbUq':_0x1dce7d(0x16b)};try{const {Id_Productos:_0x35c9dc}=_0x58d32f['params'];if(!_0x35c9dc)return _0x3a766e[_0x1dce7d(0x1d7)](0x190)[_0x1dce7d(0x1f2)]({'status':_0x1dce7d(0x16b),'message':_0x42415b[_0x1dce7d(0x215)]});const _0x51d9c9=await Productos[_0x1dce7d(0x211)](_0x35c9dc);if(!_0x51d9c9)return _0x3a766e[_0x1dce7d(0x1d7)](0x194)[_0x1dce7d(0x1f2)]({'status':_0x1dce7d(0x16b),'message':_0x42415b['PGpPt']});const _0x38626c=await Producto_Tamano[_0x1dce7d(0x205)]({'where':{'Id_Productos':_0x35c9dc},'include':[{'model':Tamano,'as':_0x42415b[_0x1dce7d(0x1b4)],'attributes':[_0x1dce7d(0x112),_0x42415b[_0x1dce7d(0xfa)],_0x42415b[_0x1dce7d(0x141)],_0x42415b[_0x1dce7d(0x1cb)]]},{'model':Producto_Tamano_Insumos,'as':_0x1dce7d(0x161),'include':[{'model':Insumos,'as':_0x42415b[_0x1dce7d(0x1a4)],'attributes':[_0x42415b[_0x1dce7d(0x286)],_0x42415b[_0x1dce7d(0xfa)],_0x42415b[_0x1dce7d(0x25a)],_0x1dce7d(0x1ef),_0x42415b[_0x1dce7d(0x210)]]}]}]}),_0x2b4326=_0x38626c[_0x1dce7d(0x25b)](_0x379172=>{const _0x154403=_0x1dce7d,_0x339c0f=_0x379172[_0x154403(0x161)]?.[_0x154403(0x25b)](_0x36475d=>({'Id_Insumo':_0x36475d[_0x154403(0x1a1)]?.['Id_Insumos'],'Nombre':_0x36475d['Id_Insumos_Insumo']?.[_0x154403(0x1d2)]||'N/A','Stock':_0x36475d['Id_Insumos_Insumo']?.[_0x154403(0x19f)]||0x0,'Cantidad_Consumo':_0x36475d[_0x154403(0x26a)]||0x0,'Unidad_Medida':_0x36475d[_0x154403(0x1a1)]?.[_0x154403(0x1ef)]||'N/A','Id_Categoria':_0x36475d[_0x154403(0x1a1)]?.[_0x154403(0x128)]||_0x154403(0x15f)}))||[];return{'Id_Producto_Tamano':_0x379172['Id_Producto_Tamano'],'Id_Tamano':_0x379172['Id_Tamano'],'Nombre_Tamano':_0x379172[_0x154403(0x171)]?.[_0x154403(0x1d2)]||_0x42415b[_0x154403(0x1dc)],'Cantidad_Maxima':_0x379172[_0x154403(0x171)]?.[_0x154403(0x136)]||0x0,'Precio_Venta':_0x379172[_0x154403(0x171)]?.['Precio_Venta']||0x0,'Total_Insumos':_0x339c0f[_0x154403(0x1d4)],'Insumos':_0x339c0f,'Insumos_Por_Categoria':_0x339c0f['reduce']((_0x13f165,_0x31cd1a)=>{const _0x5a0a2f=_0x154403,_0x339e51=_0x31cd1a[_0x5a0a2f(0x121)]||_0x42415b[_0x5a0a2f(0x24d)];return!_0x13f165[_0x339e51]&&(_0x13f165[_0x339e51]=[]),_0x13f165[_0x339e51][_0x5a0a2f(0x287)](_0x31cd1a),_0x13f165;},{})};}),_0x444a2c=_0x2b4326[_0x1dce7d(0x1d4)],_0x11fa8a=_0x2b4326['reduce']((_0xa4e35f,_0x191b7d)=>_0xa4e35f+_0x191b7d[_0x1dce7d(0x114)],0x0),_0x28ba92=_0x2b4326['filter'](_0x429b00=>_0x429b00['Total_Insumos']===0x0);_0x3a766e[_0x1dce7d(0x1f2)]({'status':_0x42415b[_0x1dce7d(0x15c)],'message':'Configuración\x20de\x20insumos\x20para\x20producto\x20'+_0x51d9c9[_0x1dce7d(0x1d2)],'data':{'Id_Productos':_0x51d9c9[_0x1dce7d(0x165)],'Nombre_Producto':_0x51d9c9[_0x1dce7d(0x1d2)],'Resumen':{'Total_Tamanos':_0x444a2c,'Total_Insumos_Configurados':_0x11fa8a,'Tamanos_Sin_Insumos':_0x28ba92[_0x1dce7d(0x1d4)],'Promedio_Insumos_Por_Tamaño':_0x444a2c>0x0?(_0x11fa8a/_0x444a2c)[_0x1dce7d(0x282)](0x2):0x0},'Configuracion_Completa':_0x2b4326,'Alertas':_0x42415b[_0x1dce7d(0x226)](_0x28ba92[_0x1dce7d(0x1d4)],0x0)?[_0x28ba92[_0x1dce7d(0x1d4)]+_0x1dce7d(0x1e8)+_0x28ba92[_0x1dce7d(0x25b)](_0x4c2f13=>_0x4c2f13[_0x1dce7d(0x1f5)])[_0x1dce7d(0x22a)](',\x20')]:[]}});}catch(_0x3f1d0f){console[_0x1dce7d(0x16b)](_0x42415b[_0x1dce7d(0x108)],_0x3f1d0f),_0x3a766e[_0x1dce7d(0x1d7)](0x1f4)['json']({'status':_0x42415b['pkbUq'],'message':_0x1dce7d(0x17e),'detail':_0x3f1d0f[_0x1dce7d(0x1ee)]});}},exports['diagnosticarInsumosTamaño']=async(_0xb7271,_0x34e3f9)=>{const _0x5e404d=a0_0x2178a1,_0x11ac29={'oGEXW':function(_0x4fcda0,_0x97905a){return _0x4fcda0+_0x97905a;},'VLOMR':_0x5e404d(0x16b),'LzsPk':_0x5e404d(0x1a1),'ehxVs':_0x5e404d(0xfe),'RVeUt':_0x5e404d(0x196)};try{const {Id_Productos:_0x11a3cd,nombreTamano:_0x1a6dcf}=_0xb7271['params'],_0x2561da=await Tamano[_0x5e404d(0x10b)]({'where':{'Nombre':_0x1a6dcf}});if(!_0x2561da)return _0x34e3f9[_0x5e404d(0x1d7)](0x194)[_0x5e404d(0x1f2)]({'status':_0x5e404d(0x16b),'message':_0x5e404d(0x278)+_0x1a6dcf+'\x20no\x20encontrado'});const _0x253dbf=await Producto_Tamano[_0x5e404d(0x10b)]({'where':{'Id_Productos':_0x11a3cd,'Id_Tamano':_0x2561da[_0x5e404d(0x112)]}});if(!_0x253dbf)return _0x34e3f9[_0x5e404d(0x1d7)](0x194)[_0x5e404d(0x1f2)]({'status':_0x11ac29['VLOMR'],'message':_0x5e404d(0x1b2)+_0x1a6dcf});const _0x56c643=await Producto_Tamano_Insumos[_0x5e404d(0x205)]({'where':{'Id_Producto_Tamano':_0x253dbf[_0x5e404d(0x132)]},'include':[{'model':Insumos,'as':_0x11ac29[_0x5e404d(0x1d6)],'required':!![]}]}),_0x4a20bc=_0x56c643[_0x5e404d(0x25b)]((_0x5840e5,_0x1ea35f)=>{const _0x49490a=_0x5e404d,_0x4fffa8={'index':_0x11ac29['oGEXW'](_0x1ea35f,0x1),'Id_Insumo':_0x5840e5[_0x49490a(0x1a1)]['Id_Insumos'],'Nombre':_0x5840e5[_0x49490a(0x1a1)][_0x49490a(0x1d2)],'Cantidad_Consumo':_0x5840e5['Cantidad_Consumo'],'Stock_Actual':_0x5840e5['Id_Insumos_Insumo'][_0x49490a(0x19f)]};return _0x4fffa8;}),_0x5ea3b5={'status':_0x11ac29[_0x5e404d(0x14e)],'producto_id':_0x11a3cd,'tamano':{'nombre':_0x2561da['Nombre'],'id':_0x2561da[_0x5e404d(0x112)],'cantidad_maxima':_0x2561da[_0x5e404d(0x136)],'precio_venta':_0x2561da[_0x5e404d(0x1ab)]},'insumos_configurados':_0x4a20bc,'total_insumos':_0x56c643[_0x5e404d(0x1d4)]};return _0x34e3f9[_0x5e404d(0x1f2)](_0x5ea3b5);}catch(_0x156fa6){return console[_0x5e404d(0x16b)](_0x11ac29[_0x5e404d(0x26f)],_0x156fa6),_0x34e3f9[_0x5e404d(0x1d7)](0x1f4)[_0x5e404d(0x1f2)]({'status':_0x11ac29['VLOMR'],'message':_0x156fa6['message']});}};function a0_0x265e(){const _0x82345e=['cSuzT','map','Nombre\x20de\x20tamaño\x20no\x20válido\x20para\x20el\x20producto\x20','beqjX','PuTlg','rollback','commit','FtzJJ','xPdQI','JHQDb','reporteVentasDiarias','Error\x20al\x20generar\x20reporte\x20mensual:','Estado','Precio','no\x20coincide','OFuKB','Cantidad_Consumo','Duplicado\x20en\x20campo\x20único','\x20x\x20','params','total','RVeUt','Id_Empleados','rjojV','create','Cliente\x20no\x20encontrado','toJSON','arcRy','Tallas_Data','7sjDcQV','Tamaño\x20','slice','lhzlD','Error\x20al\x20crear\x20venta:','jgcoB','BKMBZ','5863636uEChpr','Método\x20de\x20pago\x20no\x20válido','oxdpe','Id_Producto_Tamano_Insumos','toFixed','precio','PSE','84748rIldtP','VBqNB','push','Producto\x20desconocido','rnsPM','puhTl','aombL','eolxN','EawcX','wnVSu','fragancia','oRPBt','vSKuG','JturV','stringify','success','fSvmD','Error\x20al\x20listar\x20ventas:','zkbji','bFDar','Error\x20al\x20obtener\x20ventas','Error\x20al\x20obtener\x20tallas\x20del\x20producto','Id_Cliente',',\x20Solicitado:\x20','cSleo','SnAAH','OSagb','query','findOne','Tamanos_Data','getFullYear','Id_Agendamientos','kKWol','YSNNC','hCqSo','Id_Tamano','ID\x20de\x20producto\x20es\x20requerido','Total_Insumos','has','body','Id_Producto_Tallas_Producto_Talla','wIGMY','verificarInsumosProducto','Tamanos_Original','tieneTamanos','KTEca','Fecha','Venta\x20no\x20encontrada','descripcionTallas','iVbti','Id_Categoria','HJjBv','Tamanos_Data_Original','TCYhg','La\x20transferencia\x20requiere\x20número\x20de\x20referencia','Venta\x20marcada\x20como\x20completada\x20correctamente','FcsnT','Id_Categoria_Insumos','tHrvH','XGZWO','Detalle\x20de\x20venta\x20es\x20requerido\x20y\x20debe\x20ser\x20un\x20array\x20no\x20vacío','qcZtD','Error\x20al\x20generar\x20reporte\x20diario','Error\x20al\x20marcar\x20venta\x20como\x20completada:\x20','DOasu','tPHQt','MGaek','Id_Producto_Tamano','development','Error\x20al\x20obtener\x20tamaños\x20del\x20producto:','obtenerTamanoPorNombre','Cantidad_Maxima','JBhcE','bwuFD','El\x20producto\x20','../config/db','Conflicto\x20de\x20datos\x20únicos','Stock\x20general\x20insuficiente\x20para\x20el\x20producto\x20','NcKIN','Error\x20al\x20obtener\x20venta','FOPxP','VWDSk','xWBpy','HGGGJ',',\x20Necesario:\x20','JvjVA','Total','cantidad','Id_Tallas','15954csscqp','XdWrc','Id_Insumos','M_Pago','10ZsNBpy','Error\x20de\x20base\x20de\x20datos','ehxVs','DkqmG','Detalle_Venta','XfMZW','hHjme','rZjVF','env','hfzuK','pJrlR','HQMKX','xaMxj','wkaPq','Fecha_Anulacion','Efectivo','eMzSO','iddbg','LLdxj','N/A','split','Producto_Tamano_Insumos','Id_Ventas','iLFem','zLEbz','Id_Productos','WIDqs','pHrKH','ENOCe','Transferencia','vDpNQ','error','ugNdS','TxhxY','Id_Agendamientos_Agendamiento','SflPJ','bjdgF','Id_Tamano_Tamano','Stock\x20insuficiente\x20para\x20el\x20producto\x20','toISOString',',\x20solicitado\x20','LIaIm','QCHVl','Id_Tallas_Talla','Ceyql','cUWRG','Nombre\x20de\x20tamaño\x20no\x20válido','yEBLX','Id_Servicio','sSEJk','Error\x20al\x20verificar\x20configuración\x20de\x20insumos\x20del\x20producto','Venta\x20anulada\x20correctamente','ID\x20de\x20producto\x20es\x20requerido\x20para\x20todos\x20los\x20items','trim','tINhh','OpoYB','Myhll','cxrRC','JBiln','SDTka','Error\x20al\x20anular\x20venta:\x20','toString','stock_general','EEAzi','Error\x20al\x20marcar\x20venta\x20como\x20completada:','zIHfK','JTGEG','Error\x20al\x20verificar\x20configuración\x20de\x20insumos:','NQfdX','tkeQe','bxDhH','Agendamiento\x20no\x20encontrado','HRJox','sort','Error\x20en\x20diagnóstico:','qCILk','hMhZj','producto','Faltan\x20datos\x20requeridos','jRMba','PWGoz','12148088BUnwuQ','Error\x20al\x20validar\x20stock','Stock','FkAyN','Id_Insumos_Insumo','Id_Producto_Tallas','OcOar','csxru','Error\x20al\x20validar\x20stock\x20de\x20venta','npOhg','Producto\x20no\x20encontrado','NegIU','AZIFP','rDjXC','Precio_Venta','reduce','iSSwM','pWteg','ONebv','jUMsP','Subtotal','No\x20se\x20encontró\x20la\x20relación\x20producto-tamaño\x20para\x20','ZKMNx','GYtZs','ogfZJ','Id_Empleados_Empleado','qhjTQ','\x20no\x20encontrado','Tamano_Insumos','ejPdp','verificarConfiguracionInsumosProducto','Error\x20al\x20obtener\x20venta\x20por\x20ID:','Zbqoo','WcLRo','18729733KGoQSq','descripcionTamanos','Insumos\x20configurados\x20para\x20producto\x20','DhmwJ','aJkDC','IgGoc','tamaño','iKotN','sequelize','listarVentas','RBlwX','uFXLR','GYvUr','Empleado\x20no\x20encontrado','Nombre\x20de\x20talla\x20no\x20válido\x20para\x20el\x20producto\x20','obtenerVentaPorId','2158830RNcMmk','NODE_ENV','ySTtG','Nombre','aPgEK','length','NewMg','LzsPk','status','dBjrn','Tamaño\x20no\x20configurado\x20para\x20este\x20producto','Servicio','.\x20Disponible:\x20','esSGk','includes','WlwBR','Tallas_Data_Original','jhLpA','no\x20encontrado','sEvli','\x20requiere\x20especificar\x20tallas.\x20Tallas\x20disponibles:\x20','mplAU','SmQnT','Talla\x20','between','\x20tamaño(s)\x20sin\x20insumos\x20configurados:\x20','Stock\x20insuficiente\x20para\x20fragancia\x20','Stock\x20insuficiente\x20para\x20talla\x20','MpHQP',':\x20disponible\x20','Error\x20al\x20obtener\x20tamaños\x20del\x20producto','message','Unidad_Medida','mhmQN','\x20no\x20tiene\x20el\x20tamaño\x20','json','Venta\x20creada\x20correctamente','Error\x20al\x20anular\x20venta:','Nombre_Tamano','Error\x20al\x20generar\x20reporte\x20diario:','LFsaz','Nombre\x20de\x20talla\x20no\x20válido','0|1|5|3|6|2|4','talla','tXLZI','GtoKv','\x20no\x20encontrada\x20para\x20el\x20producto\x20','OhNzj',',\x20tamaño\x20','\x20x\x20Talla\x20','Id_Productos_Producto','hTxxy','filter','isArray','findAll','PrecioTotal','nombre','vtJBt','swjZP','ghQAy','obtenerTamanosProducto','QaiAw','update','xrLhr','pvARB','UrquS','findByPk','Tallas','Id_Producto_Tamano_Insumos_Producto_Tamano_Insumo','PdMBG','GVKKD','\x20no\x20encontrada','VQGqc','140zMzCNQ','detalleTalla','NahKs','40aCRIuA','Nombre\x20del\x20tamaño\x20es\x20requerido','Talla\x20no\x20encontrada','Error\x20al\x20verificar\x20insumos\x20del\x20producto','Producto\x20con\x20ID\x20','validarStock','\x20configurado','zDYon','Error\x20inesperado\x20al\x20crear\x20venta','ThnCA','zYgIk','sRlgg','Error\x20al\x20obtener\x20tamaño\x20por\x20nombre:','La\x20venta\x20debe\x20tener\x20estado\x203\x20(pendiente)\x20para\x20poder\x20marcarla\x20como\x20completada','WeGTH','join','Tallas_Original','rTXvY','ojIDm','Error\x20al\x20obtener\x20tamaño\x20por\x20nombre','RhONw','jlwTA','15397101wVZjcC','getDate','setHours','Completada','Czqsu','La\x20venta\x20debe\x20tener\x20estado\x203\x20(pendiente)\x20para\x20poder\x20anularla','urCvo','wVnJr','parse','tQVmD','Talla','HOvxm','../models','Anulada','Tamanos','pDoKy','Error\x20al\x20validar\x20stock:','jTZih','bgXEI','tieneTallas','tlIxe','BBelF','Error\x20al\x20anular\x20venta','owOZQ','zpzhL','Referencia','XLmoA','Fecha_Completado','pCyDl','Producto\x20requiere\x20tallas','Stock\x20insuficiente\x20para\x20insumo\x20general\x20','anularVenta','cSYuG','gsxAo','set','Cantidad','forEach','aiiKK','KvbyB','nBvGr','izPTF'];a0_0x265e=function(){return _0x82345e;};return a0_0x265e();}